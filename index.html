<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>SPWidgets by Paul Tavares</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <link rel="stylesheet" href="stylesheets/main.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <script type="text/javascript" src="javascripts/main.js" ></script>
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>SPWidgets</h1>
        <p>SharePoint Custom UI Widgets</p>

        <p class="view"><a href="https://github.com/purtuga/SPWidgets">View the Project on GitHub <small>purtuga/SPWidgets</small></a></p>


        <ul>
          <li id="ptLatestDownload"><a href="https://github.com/purtuga/SPWidgets/releases/latest">Download <strong>Latest</strong></a></li>
          <li><a href="https://github.com/purtuga/SPWidgets/releases">Download <strong>Other</strong></a></li>
          <li><a href="https://github.com/purtuga/SPWidgets">View On <strong>GitHub</strong></a></li>
        </ul>

        <div>
            <h3>Widget List</h3>
            <div class="pt-widget-menu"></div>
        </div>

      </header>
      <section>
<!-- ===============[[ doc below ]]================ -->

<h2>About</h2>

<p>SPWidgets is a jQuery plugin that provides SharePoint Widgets that can be used for creating customized User Interfaces (UI) on the SharePoint platform using Client Side scripting (javascript).</p>

<p>For the latest information on this plugin, see the <a href="http://purtuga.github.com/SPWidgets/">project page on GIT</a>.</p>

<h2>Demo Showcase</h2>

<p>Want to try them now and not worry about installation/setup etc. A self contained Single Page Application (SPA) is available that you can quickly upload to a Sharepoint library and see the widgets in action. <a href="https://github.com/purtuga/SPWidgets/blob/master/demo/demo.about.md#spwidgets-demo"><strong>GO HERE</strong></a> for more information.</p>

<h2>Dependencies</h2>

<p>SPWidgets has the following dependencies:</p>

<ol>
<li><a href="http://jquery.com">jQuery</a></li>
<li><a href="http://jqueryui.com">jQuery UI</a></li>
</ol>

<h2>Usage</h2>

<p>The following is an example that loads the required libraries from CDN's, the SPWidgets from the local site and then initiates the People Picker plugin on an input field inside a jQuery UI dialog.</p>

<pre><code>&lt;link rel="stylesheet" type="text/css" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/themes/redmond/jquery-ui.css" /&gt;
&lt;script type="text/javascript" src='https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js'&gt;&lt;/script&gt;
&lt;script type="text/javascript" src='https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.min.js'&gt;&lt;/script&gt;
&lt;script type="text/javascript" src='yoursite/path/to/jquery.SPWidgets.js'&gt;&lt;/script&gt;
&lt;script type="text/javascript"&gt;
    $(document).ready(function(){
        $('&lt;div&gt; &lt;input name="users" value="" /&gt; &lt;/div&gt;')
            .appendTo("body")
            .find("input")
                .pickSPUser()
                .end()
            .dialog();
    });
&lt;/script&gt;
</code></pre>

<h2>License</h2>

<p>Dual License support</p>

<ul>
<li><a href="http://www.opensource.org/licenses/mit-license.php">MIT</a></li>
<li><a href="http://www.opensource.org/licenses/gpl-license.php">GPL</a></li>
</ul>

<p>User can pick whichever one applies best for their project and does'nt not have to contact me.</p>

<h2>Author</h2>

<p><span id="ptAuthorInfo">
<a href="http://paultavares.wordpress.com">Paul Tavares</a> @purtuga</p>

<p>Follow me at Twitter <a href="https://twitter.com/paul_tavares">@paul_tavares</a>
</span></p>

<h2>Version</h2>

<ul>
<li>Version: 2.5.3</li>
<li>Build Date: 2015-10-31</li>
</ul>

<h2>Install</h2>

<p>SPWidgets requires jQuery and jQuery UI libraries. These should be included or loaded first. There is only 1 SPWidgets file required to be included in the page. This file can be located in the <code>dist</code> folder of the downloaded archive (zip, tar). There are two versions of it:</p>

<ul>
<li><code>jquery.SPWidgets.js</code><br/>
The un-minified version of SPWidgets, normally used for debugging during development cycle.</li>
<li><code>jquery.SPWidgets.min.js</code><br/>
The minified version of SPWidgets, usually the preferred version for production environments.</li>
</ul>

<p>Include only one of the above reference files:</p>

<pre><code>&lt;script type="text/javascript" src='yoursite/path/to/jquery.SPWidgets.min.js'&gt;&lt;/script&gt;
</code></pre>

<h1>SPShowBoard Widget</h1>

<p>Given a selector (an html element), this method will insert a Kan-Ban board inside of it based on one of the columns from the desired List.  The column must be of type Lookup or Choice, and it's values will be used by this widget to build the Board columns.
The widget support both columns set as Required or Optional and has input parameters available to filter the list of columns created. Currently, this widget supports no more than 20 columns total, with no more than 10 displayed at one time.</p>

<p>Below is a screen capture from the available demo:</p>

<p><img src="web/spwidgets.board.jpg" alt="Board Widget" title="" /></p>

<h2>Usage</h2>

<pre><code>$("#board").SPShowBoard({
    list: "Tasks",
    field: "Status"
});
</code></pre>

<h2>Input Parameters</h2>

<p>This method takes as input an object containing the supported options:</p>

<pre><code>    $("#board").SPShowBoard({
        list:                   '',
        field:                  '',
        CAMLQuery:              '&lt;Query&gt;&lt;/Query&gt;',
        CAMLViewFields:         '',
        fieldFilter:            null,
        optionalLabel:          '(none)',
        allowFieldBlanks:       null,
        template:               null,
        webURL:                 $().SPServices.SPGetCurrentSite(),
        showColPicker:          false,
        height:                 null,
        colPickerLabel:         "Columns",
        colPickerCloseLabel:    "Close",
        colPickerApplyLabel:    "Apply",
        colPickerCheckLabel:    "Check-Uncheck All",
        colPickerMaxColMsg:     "Can not exceed 10 columns!",
        colPickerMinColMsg:     "Mininum of 2 required!",
        onGetListItems:         null,
        onPreUpdate:            null,
        onBoardCreate:          null
    });
</code></pre>

<p>The default options for this widget can be manipulated/set via the following object:</p>

<pre><code>    $.SPWidgets.defaults.board = {}
</code></pre>

<h3>Options</h3>

<ul>
<li><p><strong>list</strong>      :   <em>String. Required.</em> <br>
The list name or UID.</p></li>
<li><p><strong>field</strong>     :   <em>String. Required.</em> <br>
The field from the List from where the board should
be built from. This field should be either of type
CHOICE or LOOKUP.</p></li>
<li><p><strong>CAMLQuery</strong> :   <em>String|Function. Optional. Default=&lt;Query&gt;&lt;/Query&gt;</em> <br>
String with CAML query to be used against the list to filter what is displayed or a function that will provide the list of items (an array).</p>

<p><em>Defining a Function</em><br>
If defining a Function, it must generate an array of objects with the list data that will be used to create the board items. That array of objects is then given to Board widget by calling the first input paramter given to this function.</p>

<blockquote>
  <p><em>NOTE</em>: The Board widget support objects whose attribue values are of type Function. Thus the use of frameworks such as <a href="http://knockoutjs.com/" title="Knockout - JavaScript UIs with MVVM">knockout.js</a> to build view models is supported. See Example 3 below for such an use case.</p>
</blockquote>

<p>The function will have a scope (this keyword) of the HTML element where this widget was bound and be given two input parameter:</p>

<ul><li><em>{Function}</em> A function that must be called and be given the array of objects each representing the List row to be displayed. See example below.</li>
<li><em>{Object}</em> The options defined on input to this widget.</li></ul>

<p>Example: Use of a string with the Query defined:</p>

<pre><code>options.CAMLQuery = '&lt;Query&gt;&lt;Where&gt;' +
        '&lt;FieldRef Name="Project" /&gt;' +
        '&lt;Value Type="Text"&gt;Latin America&lt;/Value&gt;' +
    '&lt;/Where&gt;&lt;/Query&gt;';
</code></pre>

<p>Example: Use of a function that will return the List rows:</p>

<pre><code>options.CAMLQuery = function(sendResults, options) {
        //       this = html element
        // get Rows from DB
        $().SPServices({
            operation:  "GetListItems",
            listName:   "Tasks",
            async:      true,
            CAMLQuery:  '&lt;Query&gt;&lt;Where&gt;' +
                            '&lt;FieldRef Name="Project" /&gt;' +
                            '&lt;Value Type="Text"&gt;Latin America&lt;/Value&gt;' +
                        '&lt;/Where&gt;&lt;/Query&gt;',
            CAMLRowLimit:   0,
            completefunc:   function(xData, status){
                var rows = $(xData.responseXML)
                            .SPFilterNode("z:row")
                            .SPXmlToJson({includeAllAttrs: true});
                // Call sendResults input param to
                // send it back to the SPShowBoard Widget.
                sendResults( rows );
        } //end: completefunc()
    });
}
</code></pre></li>
<li><p><strong>CAMLViewFields</strong>    :   <em>String. Optional. Default=""</em> <br>
String in CAML format with list of fields to be returned from the list when retrieving the rows to be displayed on the board. If left blank, the ID, TITLE and the column defined for the <em>field</em> option will be used, as they are the minimum set required to build a board with the default options.</p>

<p>Example:</p>

<pre><code>CAMLViewFields: '&lt;ViewFields&gt;' +
        '&lt;FieldRef Name="Title" /&gt;' +
        '&lt;FieldRef Name="ID" /&gt;' +
        '&lt;FieldRef Name="Attachments" /&gt;' +
        '&lt;FieldRef Name="Author" /&gt;' +
        '&lt;FieldRef Name="Editor" /&gt;' +
        '&lt;FieldRef Name="Created" /&gt;' +
        '&lt;FieldRef Name="Modified" /&gt;' +
    "&lt;/ViewFields&gt;"
</code></pre></li>
<li><p><strong>fieldFilter</strong>       :   <em>String. Optional. Default=""</em> <br>
For a field of type CHOICE, this option should be set to a comma delimietered list of column values to be displayed as the columns.</p>

<p>For a field of type LOOKUP, this option should be set with the CAML Query to use for retrieving the list of column values from the Lookup List.</p>

<p>Example: for a field of type CHOICE</p>

<pre><code>options.fieldFilter: "Not Started,In Progress,Completed,Deferred"
</code></pre>

<p>Example: for a field of type LOOKUP</p>

<pre><code>options.fieldFilter: "&lt;Query&gt;" +
            "&lt;Where&gt;" +
                "&lt;Or&gt;" +
                    "&lt;Eq&gt;" +
                        "&lt;FieldRef Name='State' /&gt;" +
                        "&lt;Value Type='Text'&gt;New Jersey&lt;/Value&gt;" +
                    "&lt;/Eq&gt;" +
                    "&lt;Eq&gt;" +
                        "&lt;FieldRef Name='State' /&gt;" +
                        "&lt;Value Type='Text'&gt;Alabama&lt;/Value&gt;" +
                    "&lt;/Eq&gt;" +
               "&lt;/Or&gt;" +
            "&lt;/Where&gt;" +
            "&lt;OrderBy&gt;" +
                "&lt;FieldRef Name='State' Ascending='True' /&gt;" +
            "&lt;/OrderBy&gt;" +
        "&lt;/Query&gt;"
</code></pre></li>
<li><p><strong>allowFieldBlanks</strong>     :   <em>Null|Boolean. Optional. Default=null</em> <br>
Controls whether an additional board state is shown that allows for items to be set to "none", which mean the value store for that Field is blank. By default, the Board widget will attempt to determine the correct behavior based on the Field List definition. Posisble values are:</p>

<ul><li><code>null</code> : (Default). Widget will figure it out.</li>
<li><code>true</code> : Always show the "(none)" column. Note that if the field is setup as Required, updates to the item may fail.</li>
<li><code>false</code>: Always hide the "none" column, regardless of the field definition. Note that if your data has item with blanks for the field, those item will not be shown on the board.</li></ul></li>
<li><p><strong>optionalLabel</strong>     :   <em>String. Optional. Default="(none)"</em> <br>
The string to be used as the State column header when field from where Board was built is optional in the List.</p></li>
<li><p><strong>template</strong>          :   <em>String|Function. Optional. Default="&lt;div/&gt;"</em> <br>
The HTML template that will be used to for displaying items on the board. The template can container special tokens referencing List (internal) column names which are then used to replace with each row's information. Tokens are defined in the format of <em>{{Column</em>Internal<em>Name}}</em>. The defult template is defined as:</p>

<pre><code>&lt;div&gt;
    &lt;div&gt;#{{ID}}: {{Title}}&lt;/div&gt;
    &lt;div class="ui-state-active ui-corner-all spwidget-board-item-actions"&gt;
        &lt;a class="spwidgets-board-action" href="javascript:" title="View Item" data-spwidgets_id="{{ID}}" data-spwidgets_board_action="view-item"&gt;&lt;img src="/_layouts/images/icgen.gif" border="0"/&gt;&lt;/a&gt;
        &lt;a class="spwidgets-board-action" href="javascript:" title="Edit Item" data-spwidgets_id="{{ID}}" data-spwidgets_board_action="edit-item"&gt;&lt;img src="/_layouts/images/CMSEditSourceDoc.GIF" border="0"/&gt;&lt;/a&gt;
    &lt;/div&gt;
&lt;/div&gt;
</code></pre>

<p>This option can also be defined as a Function whose job is to create the markup around the List row.  The function must return a String when creating a row's UI for the first time. When defining a Function, it will be given a scope of the HTML element that container the Board and provided with two input parameters:</p>

<ul><li><em>{Object}</em> The List row being created</li>
<li><em>{jQuery | Undefined}</em> The row's current UI element if it was already created. This input parameter will be Null prior to creating the items the first time. However, if a <em>refresh</em> is done and the Row is found to to still be returned, this input parameter will point to a jQuery object holding the element UI on the Board.</li></ul>

<p>If the function returns a true value, its return value <strong>must</strong> be a String reprensing the List row with data filled out.</p>

<p>Example: return the row's markup for display on the board if not yet created:</p>

<pre><code>options.template = function(rowObj, $rowUI){
    // this = jQuery - List Item container within the board.
    //
    // If UI is already created, exit. No need to re-create
    if ($rowUI) {
        return;
    }
    // return a new item template
    return '&lt;div&gt;&lt;strong&gt;' +
            rowObj.ID + '&lt;/strong&gt;: ' +
            rowObj.Title + '&lt;/div&gt;';
}
</code></pre></li>
<li><p><strong>webURL</strong>     :   <em>String. Optional. Default=current site</em> <br>
The URL of the site that hosts the List.</p></li>
<li><p><strong>showColPicker</strong>     :   <em>Boolean. Optional. Default=false</em> <br>
If true, the column picker option will be displayed on the page. Allows user to pick which column are visible/hidden. (Since v2.1)</p></li>
<li><p><strong>height</strong>     :   <em>String. Optional. Default=null</em> <br>
If set, the board will have a fixed height and column content, if too long to display in the displayed area, will display a scroll bar for the user to scroll through the content. Value of this parameter should be a string that defined as a valid CSS length (include both an integer and associated dimention; ex: 100px).</p>

<p>Note that this value will be applied to the area of each column that displays the content only, and not the entire board markup (ex. the Column headers). The result is a board that is actually longer than the defined height. Default is null, which indicates the board does not have fixed height and will expand with the card content. (Since v2.3)</p>

<p>Example: Make the board have a fixed height</p>

<pre><code>options.height = "700px"
</code></pre></li>
<li><p><strong>colPickerVisible</strong>     :   <em>Array. Optional. Default=[]</em> <br>
An array with a list of board columns that should be visible. Used only when showColPicker is true. (Since v2.1).</p></li>
<li><p><strong>colPickerLabel</strong>      :   <em>String. Optional. Default="Columns"</em> <br>
The label for the column picker button that is displayed when <em>showColPicker</em> option is set to <em>true</em>. (Since v2.1)</p></li>
<li><p><strong>colPickerCloseLabel</strong> :   <em>String. Optional. Default="Close"</em> <br>
The label for the column picker pop-up close button.  (Since v2.1)</p></li>
<li><p><strong>colPickerApplyLabel</strong> :   <em>String. Optional. Default="Apply"</em> <br>
The label for the column picker pop-up apply button.  (Since v2.1)</p></li>
<li><p><strong>colPickerCheckLabel</strong> :   <em>String. Optional. Default="Check-Uncheck All"</em> <br>
The label for the column picker pop-up Check/UnCheck all button.  (Since v2.1)</p></li>
<li><p><strong>colPickerTotalLabel</strong> :   <em>String. Optional. Default="Selected."</em> <br>
The label for the number of column selected text on the column picker popup. (Since v2.1)</p></li>
<li><p><strong>colPickerMinColMsg</strong> :   <em>String. Optional. Default="Mininum of 2 required!"</em> <br>
The message to display on column picker if user attempts to display less than 2 columns. (Since v2.1)</p></li>
<li><p><strong>colPickerMaxColMsg</strong> :   <em>String. Optional. Default="Can not exceed 10 columns!"</em> <br>
The message to display on column picker if user attempts to display more than 10 columns. (Since v2.1)</p></li>
<li><p><strong>onGetListItems</strong>     :  <em>Function. Optional. Default=null</em> <br>
Callback function to be called after data has been
retrieved from the 'list'. Function will be given a
scope (this) of the selection they used on input to
this method and two input parameters:
An Array of Objects with the list of rows returned
from the List, and
A jQuery object representing the entire xml document
response.</p>

<p>Example:</p>

<pre><code>onGetListItems: function(items, xmlResponse){
    //this = jQuery element container selction
}
</code></pre></li>
<li><p><strong>onPreUpdate</strong>     :   <em>Function. Optional. Default=null</em> <br>
Callback function to be called just prior to a List Item update. The function should return a boolean indicating whether the update should be canceled. True will cancel the update.</p>

<p>Example:</p>

<pre><code>    options.onPreUpdate: function(ev, item, data){
        //this = jQuery element container selction
        //
        data.updates.push(["Title", "Update was made!"]);
        data.updatePromise.done(function(updatedItemObject, xData){
                alert("udpate done!");
            });
    }
</code></pre>

<p>The callback will have a scope of the item being updated and be given 3 parameters:</p>

<ul><li><p>The event object</p></li>
<li><p>The item (DOM element) that triggered the event and</p></li>
<li><p>A data object with information/methods for the current item/widget binding. The object will include two attributes that will impact the updates that will be done:</p>

<pre><code>{
    updates:        {Array},
    updatePromise:  {Object}
}
</code></pre>

<p><em>data.updates</em> <br/>
An array of updates that will be made. The array will have, to start, the update to the state that was triggered by the move in the board. Additional updates can be added.
Format will be an Array-of-Arrays, where each sub-array must have 2 items: the column name (index 0) and the column value (index 1). Example:</p>

<pre><code>data.updates = [
    ["Status", "Done"]
];
// insert additional update
data.updates.push(["Title", "New title here"]);
</code></pre>

<p><em>data.updatePromise</em><br/>
A jQuery.Promise that represents the update that will be made. This can be used to bind on additional functionality. The queued functions will be given the following on a successful update:</p>

<ul><li>{Object} The updated List Item object</li>
<li>{Object} The pre-update List Item object</li>
<li>{XMLDocument} The xml response returned from the update (xData).</li></ul>

<p>If the update fails, the queued function will be given the following:</p>

<ul><li>{String} The error message</li>
<li>{Object} jqXHR</li>
<li>{String} Status</li></ul>

<p>The context of object will be the HTML element from where the update was triggered.</p></li></ul></li>
<li><p><strong>onBoardCreate</strong>     :   <em>Function. Optional. Default=null</em> <br>
Function triggered after board is initially created. See spwidget:boardcreate event for parameters that will be given to function.</p></li>
</ul>

<h2>Return Value</h2>

<p>This plugin will return a jQuery object that contains the initially selected set of nodes (selector), thus maintaining chainability.</p>

<h2>Methods</h2>

<p>The following methods are supported:</p>

<ul>
<li><p><strong>refresh()</strong><br>
Refreshes the data in the Board by retrieving the data from the list again. During a refresh, existing board items (the html element in DOM) is not actually deleted and recreated if it already exists, but re-used. It is important to note this specially if a custom template function was defined as an input param.</p>

<p>Usage:</p>

<pre><code>$("#board").SPShowBoard("refresh");
</code></pre></li>
<li><p><strong>redraw()</strong><br>
Redraws the board without pulling in data from the list. Column heights will be normalized and jQuery UI's sortable widget will be refreshed.</p>

<p>Usage:</p>

<pre><code>$("#board").SPShowBoard("redraw");
</code></pre></li>
<li><p><strong>setVisible([columnName,...])</strong><br>
Sets the visible columns on the board. Method accepts as input an array of board column names to be displayed. A minimum of 2 must be difined and no more than 10 will be displayed. (Since 2.1)</p>

<p>Input:</p>

<ul><li>{Array|String} : this method accepts an array of board column names that should be made visible. Using an empty array will set all column to be visible.  Using a static string value of 'All' will also make all columns visible.</li></ul>

<p>Example:</p>

<pre><code>// Set only 2 columns to be visible
$("#board").SPShowBoard("setVisible", [ 'Not Started', 'Completed' ]);


// Set all column to be visible
$("#board").SPShowBoard("setVisible", []);
</code></pre></li>
<li><p><strong>setHeight(null|String)</strong><br>
Sets the height of the board column content. See the <em>options.height</em> option above to read more about the <em>height</em> parameter. (Since v2.3)</p>

<p>Example:</p>

<pre><code>// Set Height to 500px
$("#board").SPShowBoard("setHeight", "500px");


// Un-set the height and let content flow down the page
$("#board").SPShowBoard("setHeight", null);
</code></pre></li>
<li><p><strong>getColumns()</strong><br>
Returns an array of objects containing information about the board columns currently setup. The informationon each column will include the name, title and isVisible properties.</p>

<pre><code>[
    {
        name: 'internal column name',
        title: 'external column name',
        isVisible: true|false
    }
]
</code></pre>

<p>Example:</p>

<pre><code>var boardColumns = $("#board").SPShowBoard("getColumns");
</code></pre></li>
</ul>

<h2>Events</h2>

<p>This widget triggers several events that can be used to perform additional actions from those experienced in the board. In addition to the events below specific to this widget, events are also fired by the jQuery UI sortable interaction.</p>

<ul>
<li><p><strong>spwidget:boardchange</strong><br>
Event is triggered anytime a change happens in the board
The function scope (this variable) will point to the column element that received the new item and is given 3 input parameters:</p>

<ul><li><em>{jQuery}</em> A jQuery event object - the one generated by the jQuery UI sortable interaction</li>
<li><em>{HTMLElement}</em> The item (DOM element) that triggered the event</li>
<li><em>{Object}</em> A data object with information/methods for the current item/widget binding.  The objects updates attribute will contain an array of array's with the updates that will be made to the item.</li></ul>

<p>Example:</p>

<pre><code>$("body").on("spwidget:boardchange", function(ev, item, data){
    // this = column that received item;
})
</code></pre></li>
<li><p><strong>spwidget:boardcreate</strong><br>
Event is triggered when the board is first created. It has the same scope and input elements as teh spwidget:boardchange event, above.</p></li>
<li><p><strong>spwidget:boarditemadd</strong><br>
Event triggered when new items are added to the board (ex. from a refresh). Event will be given the following input params:</p>

<ul><li><em>{jQuery}</em> The event object (jquery)</li>
<li><em>{HTMLElement}</em> the item (DOM element) that triggered the event</li>
<li><em>{Object}</em> A data object with information/methods for the current item/widget binding.  The objects's .itemsModified attribute will contain an array of Objects  that were added.</li></ul></li>
<li><p><strong>spwidget:boarditemremove</strong><br>
Event triggered when items are removed from the board (ex. from a refresh). Event will be given the following input params:</p>

<ul><li><em>{jQuery}</em> the event object (jquery)</li>
<li><em>{HTMLElement}</em> the board container (DOM element)</li>
<li><em>{Object}</em> a data object with information/methods for the current item/widget binding.  The objects's .itemsModified attribute will contain an array of Objects that were removed.</li></ul></li>
<li><p><strong>spwidget:boardColumnChange</strong><br>
Event triggered when columns on the board are changed. Event will be given the following input params:</p>

<ul><li><em>{jQuery}</em> jQuery Event object</li>
<li><em>{jQuery}</em> The board container</li>
<li><em>{Array}</em> A list of board columns currently visible.</li></ul>

<p>Example:</p>

<pre><code>$("#board").on("spwidget:boardColumnChange", function(ev, $board, colArray){
    //this = $board object
    alert("Columns changed to: " + colArray.join(" | "));
});
</code></pre></li>
</ul>

<h2>Examples</h2>

<h3>Example 1</h3>

<p>Simple usage. Simply supply the required input options of <em>list</em> and <em>field</em>.</p>

<pre><code>$("&lt;div/&gt;").appendTo("body")
    .SPShowBoard({
        list:   "Tasks",
        field:  "Status"
    });
</code></pre>

<h3>Example 2</h3>

<p>Simple usage. Creates a board based on the 'Status' field of Tasks list. The Column picker button is displayed, allowing the user to manipulate the columns displayed on teh board and also changs a few of the labels on the column picker.</p>

<p>It also listens for changes in the board's visible columns and writes that information to the console (for those browsers that support it).</p>

<pre><code>$("&lt;div/&gt;")
    .appendTo("body")
    .on("spwidget:boardColumnChange", function(ev, $board, colObj){

        try {

            console.log("spwidget:boardColumnChange = Columns changed: " + colObj.join(" | "));

        } catch(e) {}

    })
    .SPShowBoard({
        list:                   "Tasks",
        field:                  "Status",
        showColPicker:          true,
        colPickerLabel:         "Choose Columns",
        colPickerCloseLabel:    "Close Picker",
        colPickerApplyLabel:    "Change"
    });
</code></pre>

<h3>Example 3</h3>

<p>This example demostrates how knockout.js can be used to create the board item UI and thus take advantage of knockout live data binding.  The example below retrieves data from the list using <a href="https://spservices.codeplex.com/" title="SPServices - jQuery Library for SharePoint Web Services">SPServices</a>, converts each row to a knockout aware object and then provides that to the Board widget.  SPWidgets Board widget supports objects whose attibute values are of type Function.</p>

<pre><code>$().SPServices({
    operation:      "GetListItems",
    async:          true,
    listName:       "Tasks",
    CAMLRowLimit:   0
})
.done(fucntion(xData, status){

    // Check for errors here

    // Get the list of rows as an array of objects
    var rows        = $(xData.responseXML)
                        .SPFilterNode("z:row")
                        .SPXmlToJson({includeAllAttrs: true}),
        rowIdMap    = {};

    // Convert each object in the array to a knockout object
    $.each(rows, function(i, thisRow){

        // Convert each property on this row to an observable object.
        for ( var column in thisRow ) {

            thisRow[ column ] =  ko.observable( thisRow[ column ] );

        }

        // create a map by ID to this row
        rowIdMap[ thisRow.ID() ] = thisRow;

    });

    // now build the Board
    var $board = $("&lt;div/&gt;").appendTo("body")
        /**
         * Event to listen to the Create and Item Add events.
         * Each time an item is added, we populate the template
         * with knockout.js
         */
        .on("spwidget:boardcreate spwidget:boarditemadd ", function(){

            $board.find("div.fill-template").each(function(){

                // get a local reference to this board item, and
                // retrieve the row ID from the markup (which was
                // included when we created the template)
                var $thisItem = $(this).removeClass("fill-template"),
                    thisRowId   = $thisItem.data("row_id");

                // Apply model to the template
                ko.applyBindings(
                    rowIdMap[ thisRowId ],
                    $thisItem[0]
                );

            });

        })
        /**
         * Create the board
         */
        .SPShowBoard({
            list:   "Tasks",
            field:  "Status",
            CAMLQuery: function(sendDataToBoard) {

                // We already got the data... Just send it to the board
                sendDataToBoard( rows );

            },
            template: function(rowObj, $rowUI) {

                // If UI is already done, exit here.
                if ($rowUI){

                    return;

                }

                // Else, Return the template that will be used by KO later
                return '&lt;div class="fill-template" data-row_id="' +
                        rowObj.ID() + '"&gt;' +
                            '&lt;div&gt;' +
                                '&lt;span data-bind="text: ID"&gt;&lt;/span&gt;' +
                                '(&lt;span data-bind="text: Status"&gt;&lt;/span&gt;)' +
                            '&lt;/div&gt;' +
                            '&lt;div data-bind="html: Description"&gt;&lt;/div&gt;' +
                        '&lt;/div&gt;';

            }
        });

});
</code></pre>

<p>Although this example does not do much with knockout, the possibilities are high specially for rich application, for things like caching approaches, data refresh strategies, etc.</p>

<h1>SPLookupField Widget</h1>

<p>SPLookupField Widget takes an input html field and converts it to a lookup field by displaying an autocomplete input area, for selecting new items from the lookup List, and displaying the already selected items on the page. This widget attempts to provide the same functionality as SharePoint's columns of type Lookup, but using more efficient methods of selecting values and presenting the user with a more modern and consistent user interface/experience across all browsers.</p>

<p>The value stored in the input field, after the user selects an item from the autocomplete field, will use the same format that SharePoint returns when a Lookup field is set, with the exception that only the ID is stored.</p>

<p>Example of the value stored when a single item selected:</p>

<pre><code>1;#
</code></pre>

<p>Example of the value stored when a 3 items are selected:</p>

<pre><code>1;#;#2;#;#3;#
</code></pre>

<p>A common utility (<em>$.SPWidgets.parseLookupFieldValue</em>) is available for parsing Lookup fields, both those created by this widget as well as those returned by SharePoint's Webservices.</p>

<p>Below is a screen capture from the available demo:</p>

<p><img src="web/spwidgets.lookupfield.jpg" alt="Lookupup Field Widget" title="" /></p>

<h2>Usage</h2>

<pre><code>$("input[name='productList']")
    .SPLookupField({
        list: 'Products'
    });
</code></pre>

<h2>Input Parameters</h2>

<p>This method takes as input an object containing the supported options:</p>

<pre><code>$("#board").SPLookupField({
    list:               '',
    allowMultiples:     true,
    inputLabel:         '',
    inputPlaceholder:   'Type and Pick',
    readOnly:           false,
    exactMatch:         true,
    uiContainer:        null,
    selectFields:       ['Title'],
    filter:             '',
    filterFields:       ['Title'],
    template:           '&lt;div&gt;{{Title}} &lt;span class="spwidgets-item-remove"&gt;[x]&lt;/span&gt;&lt;/div&gt;',
    listTemplate:       '{{Title}}',
    listHeight:         0,
    onItemAdd:          null,
    onItemRemove:       null,
    onReady:            null,
    msgNoItems:         "",
    maxResults:         50,
    minLength:          2,
    hideInput:          true,
    padDelimeter:       false,
    showSelector:       false
});
</code></pre>

<p>The default options for this widget can be manipulated/set via the following object:</p>

<pre><code>    $.SPWidgets.defaults.LookupField = {}
</code></pre>

<h3>Options</h3>

<ul>
<li><p><strong>list</strong>                :   <em>String. Required.</em> <br>
 List name from where lookup will be done.</p></li>
<li><p><strong>allowMultiples</strong>      :   <em>Boolean. Optional. Default=true</em> <br>
Should the lookup widget allows multiple selection. Set to false if wanting only 1 item to be referenced.</p></li>
<li><p><strong>inputLabel</strong>          :   <em>String. Optional. Default=''</em> <br>
The label for the input field.</p></li>
<li><p><strong>inputPlaceholder</strong>      :   <em>String. Optional. Default="Type and Pick"</em> <br>
The value to be used in the Input Field placeholder attribute (HTML5 attribute)</p></li>
<li><p><strong>exactMatch</strong>          :   <em>Boolean. Optional. Default=true</em> <br>
If set to false, then the text entered by the user will be parsed into individual keywords and a search will be done on those instead.</p></li>
<li><p><strong>readOnly</strong>      :   <em>Boolean. Optional. Default=false</em> <br>
If true, field is displayed as readonly.</p></li>
<li><p><strong>uiContainer</strong>      :   <em>Selector|Object. Optional. Default=null</em> <br>
The container where the UI widget should be inserted. Default is directly after the input field</p></li>
<li><p><strong>selectFields</strong>      :   <em>Array. Optional. Default=["Title"]</em> <br>
Array of field names (internal names) that should be returned. ID is also used when the input value by the user is an integer.</p></li>
<li><p><strong>filter</strong>      :   <em>String. Optional. Default=""</em> <br>
Any additional filter criteria (in CAML format) to be added to the query when retrieving the table rows from the Lookup list. This should be only the filtering criteria with no <em>&lt;Query&gt;</em> and no <em>&lt;where&gt;</em> clause. Example:</p>

<pre><code>&lt;Contains&gt;
    &lt;FieldRef Name="Title" /&gt;
    &lt;Value Type="Text"&gt;New&lt;/Value&gt;
&lt;/Contains&gt;
</code></pre></li>
<li><p><strong>filterOrderBy</strong>      :   <em>String. Optional. Default=""</em> <br>
The OrderBy (sort) CAML string used when retrieving values from the List.</p>

<p>Example:</p>

<pre><code>&lt;OrderBy&gt;
    &lt;FieldRef Name="Title" Ascending="TRUE"/&gt;
&lt;/OrderBy&gt;
</code></pre></li>
<li><p><strong>filterFields</strong>      :   <em>Array. Optional. Default=["Title"]</em> <br>
Array of column names (internal names) that will be used to attempt to match the user's typed input.
Example: If wanting to search the Title, "Job Description" and Notes fields for the value that the user typed in, this field would be set as follows: </p>

<pre><code>options.filterFields=[
    "Title",
    "Job_x0020_Description",
    "Notes"
]
</code></pre></li>
<li><p><strong>template</strong>      :   *String. Optional. Default='&lt;div&gt;{{Title}} &lt;span class="spwidgets-item-remove"&gt;[x]&lt;/span&gt;&lt;/div&gt;' <br>
The template (most likely html) to be used for displaying the item once selected. Use the following format for item column placeholders {{fieldInternalName}}. Any column returned in the query response from the Lookup list can be used.
When defining HTML for this value, an element containing a css class of 'spwidgets-item-remove' will be used to remove the item from the list of selected items. </p>

<p>Example:</p>

<pre><code>options.template='&lt;div&gt;{{Title}} [&lt;span class="spwidgets-item-remove"&gt;x&lt;/span&gt;]&lt;/div&gt;'
</code></pre></li>
<li><p><strong>listTemplate</strong>      :   <em>String. Optional. Default='{{Title}}'</em> <br>
The template to be used for displaying the suggested items in the autocomplete field. Use the following format for item column placeholders {{fieldInternalName}}.</p></li>
<li><p><strong>listHeight</strong>      :   <em>Number. Optional. Default=0</em> <br>
The height to be set on the Autocomplete suggestion box. Use this value when there is a chance for allot of values to be returned on a query. It will place a fixed height on the container holding the suggestions and apply a scroll bar.</p></li>
<li><p><strong>padDelimeter</strong>      :   <em>Boolean. Optional. Default=false</em> <br>
If true, then an extra delimiter (;#) will be inserted at the beginning of the stored value. This may be helpful in custom solution when attempting to filter a list column whose value has been set by this widget.  For example, if the a list container two rows whose lookup widget column held the following:</p>

<pre><code>2;#;#;#15;#
5;#;#2;#
</code></pre>

<p>And a query to this list column was done to match any row with the lookup reference to item #5, the query would most likely return both rows from the example above. (query would probably filter on 5;#). By padding the first lookup item stored, the values above would now look like the following:</p>

<pre><code>;#;#2;#;#;#15;#
;#;#5;#;#2;#
</code></pre>

<p>And a query to this column would be adjusted to filter on the column containing a value of <em>;#5;#</em> which would return the second record only.</p></li>
<li><p><strong>onReady</strong>      :   <em>Function. Optional. Default=null</em> <br>
Triggered after the LookupField has been setup. This is triggered either after completing the UI setup, or if the field already had pre-defined values, after retrieving that data and displaying it. Function will be given a scope of the original selector (the field) as well as the following input params: 1) widget container (jQuery).</p>

<p>Example:</p>

<pre><code>onReady: function(widgetCntr){
    //this=original selector to where the widget was bound
}
</code></pre></li>
<li><p><strong>onItemAdd</strong>      :   <em>Function. Optional. Default=null</em> <br>
Function that will be called when adding a new item reference to the list of currently picked item. This method could, if necessary remove the new item from the UI (ex. due to some custom validation rule).
The function will be given a scope of the bound area (the input field) as well as two input parameters: 1) A jQuery object representing the new item on the UI and 2) An object with the item's information.</p>

<p>Example:</p>

<pre><code>onItemAdd: function($newItemSelection, itemObject, widgetCntr){
    //this=original selector to where the widget was bound
}
</code></pre></li>
<li><p><strong>onItemRemove</strong>      :   <em>Function. Optional. Default=null</em> <br>
Function callback that is called when items are removed. Return Boolean false will cancel the removal of the items. Function will have a scope (<em>this</em>) of the input element to which this widget was bound and will be given the following input parameters:</p>

<ul><li>{jQuery} The list of elements on the UI that will be removed</li>
<li>{Array} An array of objects with the items that will be removed. Object contains data obtained from when the rows of data were retrieved from SharePoint</li>
<li>{jQuery} The Widget Container</li></ul>

<p>Example 1: Basic definition of callback:</p>

<pre><code>onItemRemove: function($items, itemObjects, $widgetCntr ){
    //this=bound element
}
</code></pre>

<p>Example 2: Cancel the action of removing an item from the selected list:</p>

<pre><code>onItemRemove: function($items, itemObjects, $widgetCntr ){
    return false;
}
</code></pre></li>
<li><p><strong>msgNoItems</strong>      :   <em>String. Optional. Default=""</em> <br>
Message to be displayed when no items are selected. Set this to null/blank if wanting nothing to be displayed, which will result in only the input selection field being displayed.</p></li>
<li><p><strong>maxResults</strong>      :   <em>Integer. Optional. Default=50</em> <br>
Max number of results to be returned as the user types the filter</p></li>
<li><p><strong>minLength</strong>      :   <em>Integer. Optional. Default=2</em> <br>
The minimum length before the autocomplete search is triggered.</p></li>
<li><p><strong>hideInput</strong>      :   <em>Boolean. Optional. Default=true</em> <br>
Option used only when allowMultiples is false. It will hide the input field once a value has been selected. Only way to get it displayed again is to remove existing selected item.</p></li>
<li><p><strong>showSelector</strong>      :   <em>Boolean. Optional. Default=false</em> <br>
If true, an icon will be displayed to the right of the autocomplete input field that, when clicked, displays a popup area allowing the user to browse through the lookup list items for selection.</p>

<p>This option uses the <em>listTemplate</em> option in displaying the items in the popup.  The <em>maxResults</em> option value will be used for paging the data when it is retrieved from the list. </p></li>
</ul>

<h2>Return Value</h2>

<p>This plugin will return a jQuery object that contains the initially selected
set of nodes (selector), thus maintaining chainability.</p>

<h2>Methods</h2>

<p>All methods provided by this widget are invoked by calling SPLookupField on the original input element that the widget was called on but providing the word 'method' as the first argument to the function:</p>

<pre><code>$("input[name='productList']").SPLookupField("method", "method name"[, options] )
</code></pre>

<ul>
<li><p><strong>clear()</strong><br>
The clean method removes items from the selection list. When called with no input options, all items selected will be removed.  Optionally, an object can be defined and the ID or ID's of specific items can be used as input.
Example:</p>

<pre><code>// Clears all selections
$(ele).SPLookupField("method", "clear"); // clears all


// Clear ID #5
$(ele).SPLookupField("method", "clear", { id: 5 });


// Clear ID #5 and #10
$(ele).SPLookupField("method", "clear", { id: [ 5, 10 ] });
</code></pre></li>
<li><p><strong>add(stringOfItems)</strong><br>
Adds items to the list of selected items. Note that any existing values will continue to be selected and that any additional ones added by this method will simply be appended to the selcted set. (since v2.1)</p>

<p><em>Input:</em></p>

<ul><li>{String} stringOfItems<br>
A string of items to be add in format of _ID;#TITLE.</li></ul>

<p>Example:</p>

<pre><code>$(ele).SPLookupField(
    "method", "add",
    "234;#Title of item 1;#432;#Title of item 2" );
</code></pre></li>
</ul>

<h2>Events</h2>

<p>No custom events are currently triggered by this widget. </p>

<h2>Examples</h2>

<h3>Example 1</h3>

<pre><code>$("input[name='productList']")
    .SPLookupField({
        list: 'Products'
    });
</code></pre>

<h1>SPControlUpload Widget</h1>

<p>jQuery plugin that inserts a widget into page for uploading a file to a SharePoint Document Library without having to leave the page that the user is currently on. This plugin provides a behavior similar to an async ajax call.</p>

<p>At its core, this plugin is simply uses the default SharePoint upload.aspx page inside an iframe, but manipulating it from the hosted page, so that the user is shown only a minimalist UI.  Code hooks are provided for allowing a developer to further manipulate the page(s) that may be shown after the initial upload <em>(ex. some libraries require users to fill in additional information and then check in the document. This can all be automated without user input.)</em></p>

<p>In a normal flow, the upload process follows this sequence:</p>

<ol>
<li>Display upload form. User selects a file for upload and presses the upload button.</li>
<li>File is uploaded to the server and depending on the setup, a check in page may be displayed.</li>
<li>File is checked in and file upload is complete. Page is redirected to display/list view.</li>
</ol>

<h2>Usage</h2>

<pre><code>$("div.file_upload").SPControlUpload({ listName: "Shared Documents" });
</code></pre>

<h2>Input Parameters</h2>

<p>This method takes as input an object containing the following options:</p>

<pre><code>    $("div.file_upload").SPControlUpload({
        listName:               '',
        folderPath:             '',
        uploadDonePage:         '/undefined',
        onPageChange:           null,
        onUploadDone:           null,
        uploadUrlOpt:           '',
        overwrite:              false,
        uploadPage:             '',
        overlayClass:           '',
        overlayBgColor:         'white',
        overlayMessage:         '&lt;div&gt;Working on it&lt;/div&gt;',
        selectFileMessage:      "Click here to select file...",
        uploadDoneMessage:      "Upload Successful!",
        fileNameErrorMessage:   "A file name cannot contain any of the following characters: \ / : * ? \" &amp;lt; &amp;gt; | # { } % ~ &amp;amp;",
        noFileErrorMessage:     "No file selected!",
        checkInFormHeight:      '25em',
        webURL:                 currentSiteUrl
    });
</code></pre>

<p>The default options for this widget can be manipulated/set via the following object:</p>

<pre><code>    $.SPWidgets.defaults.upload = {}
</code></pre>

<h3>Options</h3>

<ul>
<li><p><strong>listName</strong>  :   <em>String. <strong>REQUIRED.</strong></em> <br />
The name or UID of the Document Library to where this files will be uploaded. This value is used in conjuction with the <em>folderPath</em> parameter.</p>

<p>Example:</p>

<pre><code>'Shared Documents'
</code></pre>

<p>or</p>

<pre><code>'{67587-89284-93884-78827-78823}'
</code></pre></li>
<li><p><strong>webURL</strong> :  <em>String. Optional. Default="currentSiteUrl"</em> <br />
The url of the Site or Sub-site to where the file will be uploaded.</p></li>
<li><p><strong>folderPath</strong> :  <em>String. Optional. Default="/"</em> <br />
The path to the folder inside of the Document Library where the document should be uploaded to. Value can be either relative to the document library root or absolute. Default is to place the document at the root of the Document Library</p>

<p>Examples:</p>

<pre><code>'http://yourdomain.com/sites/site1/Shared Documents'
</code></pre>

<p>or</p>

<pre><code>'/sites/site1/Shared Documents'
</code></pre></li>
<li><p><strong>onUploadDone</strong> :  <em>Function. Optional. Default=null.</em> <br />
Triggered when file is successfully uploaded - or when it reaches the <em>uploadDonePage</em>. This function is triggered after a file is checkedIn (if library requires it to be checked in). Function will have a scope of the element used on input and be given 1 parameter:  An object with the upload file metadata. New with v2.2</p></li>
<li><p><strong>onPageChange</strong> :  <em>Function. Optional. Default=null.</em> <br />
Function that is called each time the state of the upload changes. The function scope (this) points to the element that was used when this method was called. The function is given one param - the event object created by this plugin that includes information about the state of the upload. See Event Object below for more information.</p>

<p>Return value of this function will control flow of plugin. Returning true (boolean), will allow processing to continue at different stages (see the event object below), while returning false (boolean) will stop flow from continuing. The check is strict; meaning that it has to be a boolean false in order for flow to stop.</p>

<pre><code>onPageChange: function(ev){
    // this=original $(selector)
    // so some processing
    return true; // allow form to proceed.
}
</code></pre></li>
<li><p><strong>uploadUrlOpt</strong> :  <em>String. Optional. Default="".</em> <br />
String of data that should be appended to the upload page url as search parameters. This string value is assumed to have already been properly escaped for use in the url.<br />
<em>NOTE</em>: The option <em>MultipleUpload</em> is NOT SUPPORTED.</p></li>
<li><p><strong>overwrite</strong> :   <em>Boolean. Optional. Default=False.</em> <br />
True or False indicating if document being uploaded should overwrite any existing one. Default is False (don't overwrite)</p></li>
<li><p><strong>overlayClass</strong> :  <em>String. Optional. Default="".</em> <br />
A css class to be associated with the overlay that is displayed over the iframe while loading of the page is going on.</p></li>
<li><p><strong>overlayBgColor</strong> : <em>String. Optional. Default="white".</em> <br />
A color to be used for the overlay area that is displayed over the iframe wile loading of the page is going on. Default is white. Set this to null if wanting only to use a class.</p></li>
<li><p><strong>checkInFormHeight</strong> : <em>String. Optional. Default="25em"</em> <br />
The height of the displayed Form that is displayed when a file required CheckIn. The form is displayed after the file has been uploaded to the document library. The display of the form does not impact the layout of the page (it is displayed using position:absolute). New with v2.2</p></li>
<li><p><strong>overlayMessage</strong> : <em>String|HTMLElement|jQuery. Optional. Default="Working on it".</em> <br />
String or object/element to be displayed inside of the overlay when it is displayed.</p></li>
<li><p><strong>selectFileLabel</strong> : <em>String. Optional. Default="Click here to select file..."</em> <br />
The label to display when no file is selected. New with v2.2</p></li>
<li><p><strong>uploadDoneMessage</strong> : <em>String. Optional. Default="Upload Successful!"</em> <br />
Message to display when file upload is completed. New with v2.2</p></li>
<li><p><strong>fileNameErrorMessage</strong> : <em>String. Optional. Default="The file name is invalid or the file is empty. A file name cannot contain any of the following characters: \ / : * ? \" &lt; &gt; | # { } % ~ &amp;"</em> <br />
Error to display when file name is invalid (ex. contains unsupported characters). New with v2.2</p></li>
<li><p><strong>noFileErrorMessage</strong> : <em>String. Optional. Default=""</em> <br />
Error to display when no file is selected (but user clicks Upload). New with v2.2</p></li>
<li><p><strong>uploadDonePage</strong> : <em>String. Optional. Default="/undefined".</em> <br />
The url of the page that should be loaded after the file has been uploaded successful. Under normal use, there should be no need to change the default on this input parameter, and it may be depricated in the future.</p></li>
<li><p><strong>uploadPage</strong> :  <em>String. Optional. Default="/_layouts/Upload.aspx".</em> <br />
The relative URL from the WebSite root to the upload page. Default is "/_layouts/Upload.aspx". This value is appended to
to the website full url. Parameter should, in normal conditions, not be changed and it may be depricated in the future.</p></li>
</ul>

<h2>Event Object</h2>

<p>The function defined for the <em>onPageChange</em> input parameter will receive as input an event object generated by this plugin. The object will contain information about the state of the upload process.</p>

<p>The following attributes can be found in the event object:</p>

<ul>
<li><p><strong>ev.state</strong>  : <em>Integer. 1|2|3</em> <br />
A value from 1 through 3 that represents the state of the phisical file. This value, along with the <em>ev.action</em> value can be used to validate user input and if appropriate, cancel the send request to the server.</p>

<ol><li><p>No File uploaded. Upload form is ready for user input. This is set when the form is initially loaded and the File html element is ready for the user to attach the file.</p></li>
<li><p>No File uploaded. User has defined a file for upload and form is now ready to be submitted to the server. This state could be used in the <em>onPageChange</em> to (for example) prevent the upload of certain file types.  See example below.</p></li>
<li><p>File has been uploaded and is now available on the server (note that it may not be checked in yet).  This state is set when the user has successfully uploaded the file to the server and no errors were encountered (example invalid file characters). This state will remain through subsequent pages if the file requires check in.</p></li></ol></li>
<li><p><strong>ev.action</strong> : <em>String. preLoad|postLoad</em>  <br />
The event action as it pertains to this plugin. Use this value in conjuction with the <em>ev.state</em> to do additional validations on user input.</p>

<p><em>preLoad</em></p>

<p>Action is taking place before the page is sent to the server. The user (or code) must have initiated an action that requires sending data to the server.</p>

<p><em>postLoad</em></p>

<p>Action is taking place after page has completed loading, but is not yet visible to the user.</p></li>
<li><p><strong>ev.hideOverlay</strong> : <em>Boolean. Default=true.</em>  <br />
Used when action=postLoad. Can be set by a callback function to false, so that the busy overlay remains displayed and is not automatically hidden.</p></li>
<li><p><strong>ev.pageUrl</strong> : <em>String.</em> <br />
The url of the page currently loaded in the iframe.</p></li>
<li><p><strong>ev.page</strong> : <em>jQuery Object.</em>  <br />
An object representing the page loaded inside the iFrame. This can be used to further manipulate the iframe's page content.</p></li>
<li><p><strong>ev.isUploadDone</strong> : <em>Boolean.</em> <br />
Indicates if the upload process is done. Basically, this means that the processes has reached the page defined in the <em>updatePageDone</em> parameter.</p></li>
<li><p><strong>ev.file</strong> : <em>Object.</em> <br />
An object that contains the metadata for the file that was successfuly uploaded. This event attribute is only populated with data once the file is uploaded to the server.</p></li>
</ul>

<h2>Return Value</h2>

<p>This plugin will return a jQuery object that contains the initially selected
set of node, thus maintaining chainability.</p>

<h2>Examples</h2>

<h3>Example 1</h3>

<p>Simple example. Upload a file to the Share Documents library and display an alert when complete.</p>

<pre><code>$("#uploadContainer")
    .SPControlUpload({
        listName: 'Shared Documents',
        onUploadDone: function(file){
            alert("File upload Done. File url: " &amp; file.EncodedAbsUrl);
        }
    });
</code></pre>

<h3>Example 2</h3>

<p>The following example creates a jQuery UI dialog to display the upload interface to the user. This example uses the onPageCHange event to do certain validations through out the upload process. The dialog closes after the file is sucessfuly uploaded. It demostrates the use of the event object's <em>state</em> and <em>isUploadDone</em> attributes.</p>

<pre><code>$('&lt;div style="height:350px;width;100%;padding:.5em;"&gt;&lt;/div&gt;')
    .appendTo("body")
    .dialog()
    .SPControlUpload({
        listName:       "Shared Documents",
        onPageChange:   function(ev){

            // If we're done with the upload, then continue to show the
            // overlay, and fade out the area that contained the upload control.
            if (ev.state == 3 &amp;&amp; ev.isUploadDone) {
                ev.hideOverlay = false;
                setTimeout(function(){
                        $(this).dialog("close").dialog("destroy");
                        alert("Upload Done!");
                    }, 1000);

            // If file was uploaded, but we have required fields to fill out,
            // then adjust page to only show the required data...
            } else if (ev.state == 3 &amp;&amp; !ev.isUploadDone) {

                // Because we're coming from the same domain, we
                // have full access to the content of the page,
                // and thus we can manipulate it. In this example
                // I hide all chrome and show only the form fields
                // the user should be filling in.
                // Note that this works because in this very simple
                // example, I assume that the required fields form
                // does not have any special fields, like people pickers,
                // etc.
                ev.page.find("form")
                    .children(":visible")
                        .css("display", "none")
                        .addClass("ptWasVisible")
                        .end()
                    .find("input[title='Name']")
                        .closest("div[id^='WebPart']")
                            .appendTo(ev.page.find("form"));
                    }

        }//end: onPageChange()
    });
</code></pre>

<h3>Example 3</h3>

<p>In this example the file that the user is attempting to upload will be checked and if not a PDF file, then an error is displayed and the file is not uploaded.</p>

<pre><code>$('&lt;div style="height:350px;width;100%;padding:.5em;"&gt;&lt;/div&gt;')
    .appendTo("body")
    .dialog()
    .SPControlUpload({
        listName:       "Shared Documents",
        onPageChange:   function(ev){

            // If we're done with the upload, then continue to show the
            // overlay, and fade out the area that contained the upload control.
            if (ev.state == 3 &amp;&amp; ev.isUploadDone) {
                ev.hideOverlay = false;
                setTimeout(function(){
                        $(this).dialog("close").dialog("destroy");
                        alert("Upload Done!");
                    }, 1000);

            // If file was uploaded, but we have required fields to fill out,
            // then adjust page to only show the required data...
            } else if (ev.state == 3 &amp;&amp; !ev.isUploadDone) {

                ev.page.find("form")
                    .children(":visible")
                        .css("display", "none")
                        .addClass("ptWasVisible")
                        .end()
                    .find("input[title='Name']")
                        .closest("div[id^='WebPart']")
                            .appendTo(ev.page.find("form"));
                    }

            // User has clicked UPLOAD. If file type not pdf, error
            } else if (ev.state == 2 &amp;&amp; ev.action === "preLoad") {
                var uploadFileName = String(ev.page.find("input[type='file']").val());
                if (uploadFileName.match(/\.pdf$/i) === null) {
                    alert("Only PDF file are allowed!!");
                    return false; // Cancel upload
                }

            }
        }//end: onPageChange()
    });
</code></pre>

<h1>SPDateField Widget</h1>

<p>SPDateField is a widgets wrapped around <a href="http://api.jqueryui.com/datepicker/" title="jQuery UI Datepicker">jQuery UI's Datepicker</a> that allows the user to pick one or more dates using their own locale format, while storing the SharePoint friendly format (YYY-MM-DD) in the input field to which this widget was bound to. In addition to wrapping the jQuery UI's datepicker, this widget also provide a timepicker which in turn returns both the date and time in the date format used by SharePoint (<a href="http://en.wikipedia.org/wiki/ISO_8601" title="ISO 8601">ISO 8601</a>). Similar to jQuery UI's Datepicker, this widget can also be used on non-input element, which will cause it to be displayed inline within the HTML selector used.</p>

<p>Below is a screen capture of this widget's being used in a Filter Panel: </p>

<p><img src="web/spwidgets.date.jpg" alt="SPDateField Widget" title="" /></p>

<p>SPDateField widget was introduced with v2.2</p>

<h2>Usage</h2>

<pre><code>$("input[name='DueDate']").SPDateField(); // on input field

$("#spdatepicker").SPDateField(); // on a DIV element
</code></pre>

<h2>Input Parameters</h2>

<p>This method takes as input an object containing the supported options:</p>

<pre><code>    $("#listFilter").SPDateField({
        allowMultiples: false,
        delimeter:      ";",
        remainOpen:     true,
        datepicker:     {
            dateFormat:         'mm/dd/yy',
            buttonImage:        '/_layouts/images/CALENDAR.GIF',
            showOn:             "both",
            buttonImageOnly:    true
        },
        dateTemplate: '{{date}} &amp;lt;span class="spwidgets-item-remove"&amp;gt;[x]&amp;lt;/span&amp;gt;',
        showTimepicker: false,
        timeFormat:     ' {{hour}}:{{minutes}} {{ampm}}',
        timeUTC:        true,
        labelHour:      'Hour',
        labelMinutes:   'Minutes',
        labelAMPM:      'AM|PM',
        labelTime:      'Time',
        labelSet:       'Set',
        onSelect:       null
    });
</code></pre>

<p>All input options are optional. The default options for this widget can be manipulated/set via the following object:</p>

<pre><code>    $.SPWidgets.defaults.date = {}
</code></pre>

<h3>Options</h3>

<ul>
<li><p><strong>allowMultiples</strong>    :   <em>Boolean. Optional. Default: false</em> <br />
Whether to allow the definition of multiple dates. When set to <em>true</em>, dates selected are stored in the input field using the <em>delimeter</em> (option below). </p></li>
<li><p><strong>delimeter</strong>    :   <em>String. Optional. Default: ";"</em> <br />
Used when <em>allowMultiples</em> is set to true. Defines the delimetered to be used when storing and parsing dates.</p></li>
<li><p><strong>remainOpen</strong>    :   <em>Boolean. Optional. Default: true</em> <br />
Used when <em>allowMultiples</em> is set to true. It will leave the Datepicker open after the user picks a date, thus allowing a quick method for selecting multiples. </p></li>
<li><p><strong>datepicker</strong>    :   <em>Object. Optional. Default: {...}</em> <br />
The <a href="http://api.jqueryui.com/datepicker/" title="jQuery UI Datepicker">Datepicker</a> options for the widget. Nearly all options supported by jQuery UI Datepicker widget can be defined with the exception of <em>altField</em> and <em>altFormat</em>. Also, note that when <em>allowMultiples</em> option is set to true, the <em>showAnim</em> Datepicker option will also not be overridden.</p>

<p>The following Datepicker options are set by default:</p>

<ol><li>dateFormat = mm/dd/yy</li>
<li>buttonImage = /_layouts/images/CALENDAR.GIF</li>
<li>showOn = both</li>
<li>buttonImageOnly = true</li></ol></li>
<li><p><strong>dateTemplate</strong>    :   <em>String. Optional. Default:...</em> <br />
Used only when <em>allowMultiples</em> is set to true. The template to be used for displayed the dates that the user selected. Default template is:</p>

<pre><code>{{date}} &lt;span class="spwidgets-item-remove"&gt;[x]&lt;/span&gt;
</code></pre>

<p>The template is rendered using SPWidgets <em>$.SPWidgets.fillTemplate</em> utility and given an object with one property, <em>date</em>, which can be used in the defined template. The date is formatted according to <em>dateFormat</em> defined with the <em>datepicker</em> options. When defining a template, an html element with a class of <em>spwidgets-item-remove</em> can be used to provide the user with the means to remove a date from the selection.</p>

<p>See section titled <em>Allow Multiples Display</em> for more information on how dates are displayed on the UI, case further manipulation is desired.</p></li>
<li><p><strong>showTimepicker</strong>    :   <em>Boolean. Optional. Default: false</em><br />
If set to true, then a datepicker along with a timepicker will be displayed for user to select both. Note that when the timepicker is used, the time selected will be appended to the date string provided by the jQuery datepicker when displayed. </p>

<p><strong>NOTE:</strong> The time picker is not as robust as the jQuery Datepicker widget. As an example, if user chooses to not use the picker and opts to type in the date and time manually, this widget will be able to parse that input.  When showTimePicker is set to <em>true</em> the used of the picker widget is assumed. </p></li>
<li><p><strong>timeFormat</strong>    :   <em>String. Optional. Default: ' {{hour}}:{{minutes}} {{ampm}}'</em><br />
Used when <em>showTimepicker</em> is set to <em>true</em>. The format that the date should be displayed with. The time string defined here will be displayed on the widget following the date selected. The following tokens can be used to define the display format:</p>

<p><em>{{hour}}</em><br>
The token will be replaced with the digit(s) representing the hour selected (ex. 4 for 4PM).</p>

<p><em>{{hour24}}</em><br>
The token will be replaced with the digits(s) representing the hour in 24h format (ex. 16 for 4PM).</p>

<p><em>{{minutes}}</em><br>
The token will be replaced with the digits representing the minutes (ex. 05 for 5 minutes).</p>

<p><em>{{ampm}}</em><br>
The token will be replaced with the words letters <em>AM</em> or <em>PM</em> depending on what time was selected.</p>

<p>Example:</p>

<pre><code>timeFormat: ' at {{minutes}} past {{hour}}{{ampm}}'
</code></pre></li>
<li><p><strong>timeUTC</strong>    :   <em>Boolean. Optional. Default: true</em><br />
Used when <em>showTimepicker</em> is set to <em>true</em>. Option affects the format of the date string generated (not the visible date and time). When set to true, a UTC compliant date and time string will be generated. Setting this to false, will generate a date in user's local time.</p></li>
<li><p><strong>labelHour</strong>    :   <em>String. Optional. Default: 'Hour'</em><br />
Used when <em>showTimepicker</em> is set to <em>true</em>. The label to be displayed next to the Hour select dropdown. </p></li>
<li><p><strong>labelMinutes</strong>    :   <em>String. Optional. Default: 'Minutes'</em><br />
Used when <em>showTimepicker</em> is set to <em>true</em>. The label to be displayed next to the Minutes select dropdown.</p></li>
<li><p><strong>labelAMPM</strong>    :   <em>String. Optional. Default: 'AM|PM'</em><br />
Used when <em>showTimepicker</em> is set to <em>true</em>. The label to be displayed next to the AM, PM select dropdown.</p></li>
<li><p><strong>labelTime</strong>    :   <em>String. Optional. Default: 'Time'</em><br />
Used when <em>showTimepicker</em> is set to <em>true</em>. The label to be shown at the top of the timepicker section.</p></li>
<li><p><strong>labelSet</strong>    :   <em>String. Optional. Default: 'Time'</em><br />
Used when <em>showTimepicker</em> and <em>allowMultiples</em> are both set to <em>true</em>. The label of the button displayed on the widget to set a date time combination.</p></li>
<li><p><strong>onSelect</strong>    :   <em>Function. Optional. Default: null</em><br />
A callback function that is called everytime a date or date/time is selected. The function will have a scope (<em>this</em>) of the element to which this widget was bound. This callback has no input parameters.</p>

<p>Example:</p>

<pre><code>$("input[name='DueDate']").SPDateField({
    onSelect: function(){
        // this = input[name='DueDate']
        alert( "Selected date: " + $(this).SPDateField("getDate").input );
    }
});
</code></pre></li>
</ul>

<h2>Return Value</h2>

<p>This plugin will return a jQuery object that contains the initially selected set of nodes (selector), thus maintaining chainability.</p>

<h2>Methods</h2>

<ul>
<li><p><strong>reset()</strong><br>
The reset method erases any dates defined on the input.</p>

<p><strong>Usage:</strong></p>

<pre><code>$("input[name='DueDate']").SPDateField("reset");
</code></pre>

<p><strong>Input</strong></p>

<p>None.</p>

<p><strong>Return Value:</strong></p>

<p>This method returns a JQuery object with the initial selections, thus maintaining jQuery's chainability.     </p></li>
<li><p><strong>getDate()</strong><br>
Returns an object with the dates currently set on the widget.</p>

<p><strong>Usage:</strong></p>

<pre><code>$("input[name='DueDate']").SPDateField("getDate");
</code></pre>

<p><strong>Input</strong></p>

<p>None.</p>

<p><strong>Return Value:</strong></p>

<p>This method returns an object with the following structure (example below shows response when <em>allowMultiples</em> is set to <em>true</em>:</p>

<pre><code>{
    input: '2013-08-01;2013-08-02',
    dates: [
        '2013-08-01',
        '2013-08-02'
    ]
}
</code></pre>

<p>Dates are provided in the SharePoint format: yyyy-mm-dd.</p></li>
<li><p><strong>setDate(dates[], "format")</strong><br>
Sets one or more dates on the widget. </p>

<p><strong>Usage:</strong></p>

<pre><code>$("input[name='DueDate']")
    .SPDateField(
        "setDate",
        [
            "08/02/2013",
            (new Date("2013", "7", "1"))
        ],
        "mm/dd/yy"
    );
</code></pre>

<p><strong>Input</strong></p>

<p><em>{Array|Date|String} dates</em><br>
Dates can be defined either as a string (ex. <em>08/01/2013</em>) or as a JavaScript Date Object.  This input parameter can be either a single value or an array of values to be set.</p>

<p>When <em>showTimepicker</em> option is <em>true</em>, if providing the dates as a string, they must be defined in the SharePoint internal format <a href="http://en.wikipedia.org/wiki/ISO_8601" title="ISO 8601">ISO 8601</a> (ex. 2013-09-05T06:00:00Z).    </p>

<p><em>{String} format</em><br>
Used only when dates are defined as a string and <em>showTimepicker</em> option is <em>false</em>. The format of the dates defined. Used with jQuery UI Datepicker <em>parseDate</em> utiltiy. For more information on the format definition, see the <a href="http://api.jqueryui.com/datepicker/" title="jQuery UI Datepicker">jQuery UI Datepicker</a> widget documentation. </p>

<p><strong>Return Value:</strong></p>

<p>This method returns a JQuery object with the initial selections, thus maintaining jQuery's chainability.     </p></li>
<li><p><strong>removeDate(dates[], "format")</strong><br>
Removes one or more dates from the Widget. </p>

<p><strong>Usage:</strong></p>

<pre><code>$("input[name='DueDate']")
    .SPDateField(
        "removeDate",
        [
            "08/02/2013",
            (new Date("2013", "7", "1"))
        ],
        "mm/dd/yy"
    );
</code></pre>

<p><strong>Input</strong></p>

<p><em>{Array|Date|String} dates</em><br>
Dates can be defined either as a string (ex. <em>08/01/2013</em>) or as a JavaScript Date Object.  This input parameter can be either a single value or an array of values to be set.</p>

<p>When <em>showTimepicker</em> option is <em>true</em>, if providing the dates as a string, they must be defined in the SharePoint internal format <a href="http://en.wikipedia.org/wiki/ISO_8601" title="ISO 8601">ISO 8601</a> (ex. 2013-09-05T06:00:00Z).    </p>

<p><em>{String} format</em><br>
Used only when dates are defined as a string and <em>showTimepicker</em> option is <em>false</em>. The format of the dates defined. Used with jQuery UI Datepicker <em>parseDate</em> utiltiy. For more information on the format definition, see the <a href="http://api.jqueryui.com/datepicker/" title="jQuery UI Datepicker">jQuery UI Datepicker</a> widget documentation.</p>

<p><strong>Return Value:</strong></p>

<p>This method returns a JQuery object with the initial selections, thus maintaining jQuery's chainability.     </p></li>
<li><p><strong>destroy()</strong><br>
Removes the SPDateWidget from the bound element. Note that any dates stored on the input element will not be removed.</p>

<p><strong>Usage:</strong></p>

<pre><code>$("input[name='DueDate']").SPDateField("destroy")
</code></pre>

<p><strong>Input</strong></p>

<p>None.</p>

<p><strong>Return Value:</strong></p>

<p>This method returns a JQuery object with the initial selections, thus maintaining jQuery's chainability.     </p></li>
</ul>

<h2>Events</h2>

<p>This widgets does not have any custom events. The input field used to bind this widget to, however, will trigger <em>change</em> events everytime a date is added or removed from it.</p>

<h2>Allow Multiples Display</h2>

<p>When <em>allowMultiples</em> is set to true, the dates selected by the user will be displayed using the <em>dateTemplate</em> value. That template is wrapped in a <em>&lt;span&gt;</em> element with a css class of <em>spwidgets-item</em>. The example below shows the rendred markup of a date using the default <em>dateTemplate</em> definition:</p>

<pre><code>&lt;span class="spwidgets-item" data-spwidget_dt1="2013-08-01" data-spwidget_dt2="08/01/2013"&gt;
    08/01/2013&lt;span class="spwidgets-item-remove"&gt;[x]&lt;/span&gt;
&lt;span&gt;
</code></pre>

<h2>Examples</h2>

<h3>Example 1 - Allow multiple dates</h3>

<pre><code>$("input[name='DueDate']").SPDateField({
    allowMultiples: true
});
</code></pre>

<h3>Example 2 - Define date to Euro format</h3>

<pre><code>$("input[name='DueDate']").SPDateField({
    datepicker: {
        dateFormat: "dd/mm/yy"
    }
});
</code></pre>

<h1>SPFilterPanel Widget</h1>

<p>Given a selector (an html element), this method will insert a UI that allows the user to enter filter criteria for a list. The widgets generates CAML filters from that data that can then be used by the hosting application to do further processing (ex. retrieve data).</p>

<p>For columns that will be displayed to the user with a text input field (ex. Text, Note, Computed, etc.) the user can enter multiple keywords by delimitering them with a semicolon.  In addition, the following columns are displayed using widgets provided by this library:</p>

<ul>
<li><p>Lookup Columns<br/>
Displayed using the SPLookupField widget. User is able to select multiple lookup values.</p></li>
<li><p>People Columns<br/>
Displayed using the pickSPUser widget. Multiple values can be selected.</p></li>
<li><p>Date and Time Columns<br/>
Displayed using the SPDateField widget. Multiple values can be selected.</p></li>
<li><p>Choice Columns<br/>
Each choice value is displayed in a scrollable area as checkboxes, thus allowing the user to pick multiples.</p></li>
</ul>

<p>Below is a screen capture from the available demo:</p>

<p><img src="web/spwidgets.filter.jpg" alt="Filter Panel Widget" title="" /></p>

<p>The SPFilterPanel widget was introduced with v2.1</p>

<h2>Usage</h2>

<pre><code>$("#listFilter").SPFilterPanel({
    list: "Tasks",
    columns: [
        'Title', 'Status', 'AssignedTo', 'Predecessors'
    ],
    onFilterClick: function(filters){

        alert("Number of filters entered by the user: " + filters.count);

    }
});
</code></pre>

<h2>Input Parameters</h2>

<p>This method takes as input an object containing the supported options:</p>

<pre><code>    $("#listFilter").SPFilterPanel({
        list:               '',
        webURL:             'current/site/url/',
        columns:            ['Title'],
        textFieldTooltip:   'Use a semicolon to delimiter multiple keywords.',
        showFilterButton:   true,
        filterButtonLabel:  "Filter",
        onFilterClick:      null,
        onReady:            null,
        ignoreKeywords:     /^(of|and|a|an|to|by|the|or|from)$/i,
        height:             null
    });
</code></pre>

<p>The default options for this widget can be manipulated/set via the following object:</p>

<pre><code>    $.SPWidgets.defaults.filter = {}
</code></pre>

<h3>Options</h3>

<ul>
<li><p><strong>list</strong>    :   <em>String. Required.</em> <br />
The List that will be used to build the filter against.</p></li>
<li><p><strong>webURL</strong>  :   <em>String. Optional. Default=_current_site_</em> <br />
The site url of the list. Defaults to the site from where the widget was executed.</p></li>
<li><p><strong>columns</strong> :   <em>Array. Optional. Default=['Title']</em> <br />
An array with the list of columns that should be displayed. Default is the Title column. Any column can be used.</p></li>
<li><p><strong>textFieldTooltip</strong>    :   <em>String. Optional. Default='Use a semicolon to delimiter multiple keywords.'</em> <br />
The text that appear below Text fields, which instructs the user that a semicolon can be used to delimiter multiple keywords.</p></li>
<li><p><strong>showFilterButton</strong>    :   <em>Boolean. Optional. Default=true</em> <br />
True or false whether the buttons panel should be displayed at the bottom of the widget. Default is true. See <em>filterButtonLabel</em> and <em>onFilterClick</em> options for more on the use of this button.</p></li>
<li><p><strong>showFilterButtonTop</strong>    :   <em>Boolean. Optional. Default=true</em> <br />
True or false whether the buttons panel should be displayed at the top of the widget. Default is true. See <em>filterButtonLabel</em> and <em>onFilterClick</em> options for more on the use of this button.</p></li>
<li><p><strong>definedClass</strong>    :   <em>Boolean. Optional. Default=spwidget-column-dirty</em> <br />
The CSS class name for columns that have received filtering criteria from the user. The default class (<em>spwidget-column-dirty</em>) highlights the column label in red.</p></li>
<li><p><strong>filterButtonLabel</strong>   :   <em>String. Optional. Default='Filter'</em> <br />
The text that will be used in the button at the bottom of the filter panel. Used only when <em>showFilterButton</em> is set to true.</p></li>
<li><p><strong>onFilterClick</strong>       :   <em>Function. Optional. Default=null</em> <br />
Used when <em>showFilterButton</em> is set to true.  Function is executed when the button is clicked. Function is have a scope of the original container HTML element (the one where the widget was inserted) and be given one parameter: A <em>Filter</em> object (see the getFilter method of this widget).</p>

<pre><code>onFilterClick: function(FilterObj) {
    // this = original container element
}
</code></pre>

<p>If a <em>onFilterClick</em> function is not set, a click event can be set on <em>button.spwidget-button</em> and the <em>getFilter</em> method used to retrieve the defined criteria.</p>

<p>Example:</p>

<pre><code>$filterPanel = $("#listFilter").SPFilterPanel({ list: "Tasks" });
$("body").on("click", "button.spwidget-button", function(){
    // this = button
    var filterCrit = $filterPanel.SPFilterPanel("getFilter");
});
</code></pre></li>
<li><p><strong>onReady</strong>      :   <em>Function. Optional. Default=null</em> <br />
A function to be executed when the widget is done being created. Function is called prior to making the widget visible and will have a scope of the original HTML element container (the one where the widget was inserted) and given one parameter: the original options object given to this widget.</p></li>
<li><p><strong>onReset</strong>      :   <em>Function. Optional. Default=null</em> <br />
A function to be executed when the widget is reset, either by the user clicking the reset button or by code calling the reset method. The function will have a scope of the original element where the filter widget was inserted and be given the following as input:</p>

<ul><li>{Object} An object with the currently defined filters on the widget. See <em>getFilter</em> method below for an example of the object structure.</li></ul>

<p>Return Value:</p>

<p>If function return a Boolean <em>true</em>, the reset action will be canceled (form will not be reset and will maintain the currently defined values).</p>

<p>Example:</p>

<pre><code>onReset: function(filters) {
    // this = HTML element
}
</code></pre></li>
<li><p><strong>ignoreKeywords</strong>      :   <em>RegEx. Optional. Default=/^(of|and|a|an|to|by|the|or|from)$/i</em> <br />
A regular expression with the list of keywords to ignore. RegEx is used when parsing the values entered by the user in text fields. Default setting ignores the following: of, and, a, an, to, by, the, or, from</p></li>
<li><p><strong>delimeter</strong>      :   <em>String. Optional. Default=";"</em> <br />
The delimeter that should be used by the user when entering multiple keywords into a text input field. Note, if changing this from the default semicolon, the <em>textFieldTooltip</em> input parameter should also be adjusted. Since v2.2</p></li>
<li><p><strong>height</strong>      :   <em>String. Optional. Default=null</em> <br />
The height for the filter panel. Must be a valid css value. This will be applied only to the area that displays the column filters. The button panels will not be impacted by this value.</p></li>
</ul>

<h2>Return Value</h2>

<p>This plugin will return a jQuery object that contains the initially selected set of nodes (selector), thus maintaining chainability.</p>

<h2>Methods</h2>

<ul>
<li><p><strong>getFilter()</strong><br />
Returns a Filter object with the values entered by the user. The object will have CAML Query ready string values as well as properties that hold the individual values entered by the user.</p>

<p>Usage:</p>

<pre><code>$("#listFilter").SPFilterPanel("getFilter");
</code></pre>

<p>The Filter object return will contain the following:</p>

<pre><code>{
    CAMLQuery: 'string with query of all columns filters wrapped in an &lt;And&gt; aggregate',
    CAMLOrderBy: 'String with OrderBy elements',
    URLParams: 'String of items in URL param style',
    filters: {
        columnInternalName: {
            matchType: 'Eq',
            logicalType: 'Or',
            values: [
                'filter value 1',
                'filter value 2',
                etc...
            ],
            CAMLQuery: 'string with query wrapped in an &lt;Or&gt; aggregate',
            CAMLOrderBy: 'String with OrderBy elements',
            URLParams: 'String in URL param style',
            count: 0,
            sortOder: 'empty or a string value of Des or Asc'
        },
        etc...
   },
   count: 2 // number of filters created
}
</code></pre></li>
<li><p><strong>setFilter(ObjectWithFilters)</strong><br />
Clears the existing set of filters defind on the panel and sets the filter panel with the criteria defined on input to this method.  Input will be an object with similar format as the <em>filters</em> attribute of the <em>getFilter</em> method.</p>

<p>Usage:</p>

<pre><code>$("#listFilter")
    .SPFilterPanel(
        "setFilter",
        {
            ID: {
                values: [ 3, 4, 5],
                matchType: 'Eq'
            },
            Title: {
                values:     'test',
                matchType:  'Contains'
            }
        }
    );
</code></pre>

<p>Input:</p>

<ul><li><p><em>{Object} ObjectWithFilters</em> An object with the list of columns internal names and the defined criteria to be set. Format of the object is:</p>

<pre><code>{
    columns_internal_name: {
        matchType: 'String. Match type. Optional',
        values: [
            'value 1',
            'value 2',
            'value 3'
        ],
        sortOrder: 'asc'
    },
    ...etc...
}
</code></pre></li></ul></li>
<li><p><strong>reset()</strong><br />
Resets the filter panel and returns all column values back to their default values.</p>

<p>Usage:</p>

<pre><code>$("#listFilter").SPFilterPanel("reset");
</code></pre></li>
<li><p><strong>destroy()</strong><br />
Removes the widget from the UI.</p>

<p>Usage:</p>

<pre><code>$("#listFilter").SPFilterPanel("destroy");
</code></pre></li>
</ul>

<h2>Examples</h2>

<h3>Example 1</h3>

<pre><code>$("&lt;div/&gt;").appendTo("body")
    .SPFilterPanel({
        list: "Tasks",
        columns: [
            'Title', 'Status', 'AssignedTo', 'Predecessors'
        ],
        onFilterClick: function(filters){

            alert("Number of filters entered by the user: " + fitlers.count);

        }
    });
</code></pre>

<h1>Common Utilities</h1>

<p>The following is a list of common utilities created internally for the widgets, but built generically and accessible externally.</p>

<h2>$.SPWidgets.fillTemplate</h2>

<p>A simple templating engine. Meant primarily for use internally by the widgets provided in this library. It simply replaces tokens in a string having a format of {{tokenName}} with the tokeName found in the data to be used to fill out the template.
(Since v. 2.0) </p>

<h3>Input Parameters</h3>

<p>The method accepts as input an Object containing the options below.</p>

<h4>Options</h4>

<ul>
<li><p><strong>tmplt</strong> :   <em>String|jQuery|Selector. Required.</em> <br />
The template to be used for the data.</p></li>
<li><p><strong>data</strong> :   <em>Object|Array. Required.</em> <br />
The object containing the data to be used in populating the template. This value can also be an Array of object, in which case, each array item will be used to build the return string.</p></li>
</ul>

<h3>Return Value</h3>

<p>This method will return a String with the template filled out with the data.</p>

<h3>Example</h3>

<pre><code>$.SPWidgets.fillTemplate({
    tmplt: '&lt;div&gt;{{Title}}&lt;/div&gt;',
    data: [
        { Title: "Record number 1" },
        { Title: "Record number 2" },
        { Title: "Record number 3" },
        { Title: "Record number 4" }
    ]
});
</code></pre>

<h2>$.SPWidgets.getCamlLogical</h2>

<p>Given an array of individual CAML filters, this method will wrap them all in a Logical condition (&lt;And&gt;&lt;/And&gt; or a &lt;Or&gt;&lt;/Or&gt;). The result (a string) will be returned to the caller. This method takes care of building the proper format required by the CAML conditional aggregates.
(Since v. 2.0) </p>

<h3>Input Parameters</h3>

<p>The method accepts as input an Object containing the options below.</p>

<h4>Options</h4>

<ul>
<li><p><strong>values</strong> :   <em>Array. Required</em> <br />
The array of String elements that will be join into caml Logical condition.</p></li>
<li><p><strong>type</strong> :   <em>String. Optional. Default="AND"</em> <br />
Static String. The type of logical condition that the <em>values</em> should be wrapped in. Possible values are <em>AND</em> or <em>OR</em>.  Default is 'AND'.</p></li>
<li><p><strong>onEachValue</strong> :   <em>Function. Optional. Default=null</em> <br />
A function to process each items in the <em>values</em> array. Function must return the value that should be used in the logial concatenation.
Function is given 1 input param - the item currently being processed (from the <em>values</em> input param).</p></li>
</ul>

<h3>Return Value</h3>

<p>This method return a String containing the concatenated filter values in the appropriate AND or OR logical aggregate. </p>

<h3>Example 1</h3>

<pre><code>$.SPWidgets.getCamlLogical({
    type: "or",
    values: [
        "&lt;Eq&gt;&lt;FieldRef Name='Title' /&gt;&lt;Value Type='Text'&gt;Test&lt;/Value&gt;&lt;/Eq&gt;",
        "&lt;Eq&gt;&lt;FieldRef Name='Title' /&gt;&lt;Value Type='Text'&gt;Test1&lt;/Value&gt;&lt;/Eq&gt;",
        "&lt;Eq&gt;&lt;FieldRef Name='Title' /&gt;&lt;Value Type='Text'&gt;Test2&lt;/Value&gt;&lt;/Eq&gt;",
        "&lt;Eq&gt;&lt;FieldRef Name='Title' /&gt;&lt;Value Type='Text'&gt;Test3&lt;/Value&gt;&lt;/Eq&gt;",
        "&lt;Eq&gt;&lt;FieldRef Name='Title' /&gt;&lt;Value Type='Text'&gt;Test4&lt;/Value&gt;&lt;/Eq&gt;"
    ]
})
</code></pre>

<h3>Example 2</h3>

<pre><code>$.SPWidgets.getCamlLogical({
    type: "and",
    values: [
        "west",
        "east"
    ],
    onEachValue: function(loc){

        return "&lt;Neq&gt;&lt;FieldRef Name='Region'/&gt;" +
                "&lt;Value Type='Text'&gt;" + loc + "&lt;/Value&gt;&lt;/Neq&gt;";

    }
})
</code></pre>

<h2>$.SPWidgets.makeSameHeight(ele, pad)</h2>

<p>Given a group of elements, this plugin will set their css <em>height</em> attribute to be at least equal to the tallest item among them.
(Since v. 2.0) </p>

<h3>Input Parameters</h3>

<ul>
<li><p><strong>ele</strong> :   <em>HTMLElement|Selector|jQuery. Required.</em> <br />
The set of elements whose height will be adjusted.</p></li>
<li><p><strong>pad</strong> :   <em>Integer. Optional. Default=0</em> <br />
Number of pixels to add on to the height. Value will be added to the calculated height of the tallest element. </p></li>
<li><p><strong>cssProp</strong> :   <em>String. Optional. Default=0</em> <br />
The CSS property to set. Default is height. (example: if wanting to instead use the min-height css property, set this input value to "min-height") </p></li>
</ul>

<h3>Return Value</h3>

<p>The <em>ele</em> input parameters is returned to the caller. </p>

<h3>Example</h3>

<p>Given the following html markup:</p>

<pre><code>&lt;div class="spwidgets-demo" style="height: 30px;" /&gt;
&lt;div class="spwidgets-demo" style="height: 100px;" /&gt;
&lt;div class="spwidgets-demo" style="height: 50px;" /&gt;
&lt;div class="spwidgets-demo" style="height: 102px;" /&gt;
</code></pre>

<p>The above elements height would be set to 102px by the following:</p>

<pre><code>$.SPWidgets.makeSameHeight( $("div.spwidgets-demo") );
</code></pre>

<h2>$.SPWidgets.parseLookupFieldValue(value)</h2>

<p>Parses a SharePoint lookup values as returned by webservices (id;#title;#id;#Title) into an array of objects where each object contains the lookup item data (ID and TITLE).
(Since v. 2.0) </p>

<h3>Input Parameters</h3>

<ul>
<li><strong>value</strong> :   <em>String. Required.</em> <br />
The column value that is returned by SharePoint's webservices for a Lookup column (normally in the format of ID;#Title) </li>
</ul>

<h3>Return Value</h3>

<p>An array of objects will be returned where each object has two keys; title and id of the lookup item that was parsed. Example:</p>

<pre><code>[
    {
        id: "1",
        title: "Title of lookup item 1"
    },
    {
        id: "2",
        title: "Title of lookup item 2"
    },
    {
        id: "3",
        title: "Title of lookup item 3"
    }
]
</code></pre>

<h3>Example</h3>

<pre><code>$.SPWidgets.parseLookupFieldValue("1;#Title of lookup item 1;#2;#Title of lookup item 2");
</code></pre>

<h2>$.SPWidgets.SPGetDateString(dateObj, formatType)</h2>

<p>Returns a date string in the format expected by SharePoint Date/time fields. Useful when wanting to obtain a date/time string for use in CAML Queries.
(Since v. 2.0) </p>

<p><em>Credit:  Matt <a href="https://twitter.com/iOnline247">twitter @iOnline247</a> in this <a href="http://spservices.codeplex.com/discussions/349356">SPServices post</a></em></p>

<h3>Input Parameters</h3>

<ul>
<li><p><strong>dateObj</strong> :   <em>Date. Optional. Default=Date()</em> <br />
The date object to use in generating the Date string.</p></li>
<li><p><strong>formatType</strong> :   <em>String. Optional. Default="local"</em> <br />
What format to use in creating the date string. Supported values are <em>local</em> for local time and <em>utc</em> for UTC time.</p></li>
</ul>

<h3>Return Value</h3>

<p>A string is returned with the date formatted in the appropriate locale.</p>

<h3>Example</h3>

<pre><code>// Return today's date formatted in local time
// Result example: 2013-05-06T13:08:10
$.SPWidgets.SPGetDateString();

// Return date formatted in UTC time
// Result example: 2013-05-06T17:09:19Z
$.SPWidgets.SPGetDateString(null, "utc");
</code></pre>

<h2>$().SPGetMsgError</h2>

<p>A jQuery method (extension of $.fn) that given a SharePoint webservices response object, will look to see if it contains an error and return that error formatted as a string. The XML response object will be checked for errors that might be returned in the following XML elements:</p>

<pre><code>&lt;ErrorCode /&gt;
&lt;faultcode /&gt;
</code></pre>

<p>(Since v. 2.0) </p>

<h3>Input Parameters</h3>

<p>None.</p>

<h3>Return Value</h3>

<p>A string with the first error found in the XML message.</p>

<h3>Example</h3>

<pre><code>alert( $(xData.responseXML).SPGetMsgError() );
</code></pre>

<h2>$().SPMsgHasError</h2>

<p>A jQuery method (extension of $.fn) that given a SharePoint webservices response object, that given an XML message as returned by the SharePoint WebServices API, will check if it contains an error and return a Boolean indicating that. The XML response object will be checked for errors that might be returned in the following XML elements:</p>

<pre><code>&lt;ErrorCode /&gt;
&lt;faultcode /&gt;
</code></pre>

<p>(Since v. 2.0) </p>

<h3>Input Parameters</h3>

<p>None.</p>

<h3>Return Value</h3>

<p>A Boolean will be returned indicating whether the XML message has an error (true) or not (false).</p>

<h3>Example</h3>

<pre><code>if ( $(xData.responseXML).SPMsgHasError() ) {

    alert("error in xml message.");

}
</code></pre>

<h2>$.SPWidgets.escapeXML</h2>

<p>Given a XML or HTML string, this utility will escape the special characters that can impact rendering when displayed as html or xml.
(Since v2.1)</p>

<h3>Input Parameters</h3>

<ul>
<li><strong>xmlString</strong>      :   <em>String. Required</em> <br />
The string to be escaped.</li>
</ul>

<h3>Return Value</h3>

<ul>
<li>String. The input parameter is returned with XML characters escaped.</li>
</ul>

<h3>Example</h3>

<pre><code>$.SPWidgets.escapeXML("This is &lt;text&gt;.");

returns:

"This is &amp;lt;text&amp;gt;."
</code></pre>

<h2>$.SPWidgets.unEscapeXML</h2>

<p>Given a string, this utility will un-escape any special characters that were escaped by $.SPWigets.escapeXML.
(Since v2.1)</p>

<h3>Input Parameters</h3>

<ul>
<li><strong>xmlString</strong>      :   <em>String. Required</em> <br />
The string to be un-escaped.</li>
</ul>

<h3>Return Value</h3>

<ul>
<li>String. The input parameter is returned with XML characters un-escaped.</li>
</ul>

<h3>Example</h3>

<pre><code>$.SPWidgets.escapeXML("This is &amp;lt;text&amp;gt;.");

returns:

"This is &lt;text&gt;."
</code></pre>

<h2>$.SPWidgets.getSPVersion</h2>

<p>Returns the SharePoint version number (Since v2.2).</p>

<h3>Input Parameters</h3>

<ul>
<li><strong>returnExternal</strong>      :   <em>Boolean. Optional. Default=false</em> <br />
By default, this function returns the SharePoint internal version number (ex. 12 for SP2007, or 14 for SP2010). Setting this value to true will return instead the external version (ex. 2007 or 2010). Note that this method is meant to get you the version of SP's client - the UI... SharePoint server version could be different.</li>
</ul>

<h3>Return Value</h3>

<ul>
<li>String or Integer. The SharePoint version. When the internal number is returned (ex. 12, 14, 15) the type will be an integer.  When the external name is returned (ex. 2007, 2010, 2013) the type is a string.</li>
</ul>

<h3>Example</h3>

<pre><code>// Under SP 2010, the following returns 14 (Integer)
$.SPWidgets.getSPVersion();

// Under SP2013, the following returns "2013" (String)
$.SPWidgets.getSPVersion(true);
</code></pre>

<h2>$.SPWidgets.parseDateString(dateString)</h2>

<p>Parses the date providedon input, which is assumed to be in ISO 8601 format, and return a JavaScript Date object.</p>

<h3>Input Parameters</h3>

<ul>
<li><strong>dateString</strong>      :   <em>String. Required</em> <br />
A string with the ISO 8601 compliant date to be parsed.</li>
</ul>

<h3>Return Value</h3>

<ul>
<li><em>{Date|Null}</em> A JavaScript Date object or, if unable to parse date, a Null object. </li>
</ul>

<h3>Example</h3>

<pre><code>$.SPWidgets.parseDateString('2013-09-02T12:00:00Z');

$.SPWidgets.parseDateString('2013-09-02T05:35:00');
</code></pre>

<h1>pickSPUser Widget</h1>

<p>Given an input field, this method will display an interface that allows the users to select one or more users from SharePoint and stores the selected user information into the input field in the format expected when making an update via webservices.</p>

<p>The input field will be hidden in its current position and a UI will displayed instead. As the user picks or removes users, the input field will be updated at the same time, thus it will always be ready to be submitted as part of an update to the server.</p>

<h2>Usage</h2>

<pre><code>$("input[name='users']").pickSPUser();
</code></pre>

<h2>Input Parameters</h2>

<p>This method takes as input an object containing the options below. These can also be set globally by setting them on <em>$.SPWidgets.defaults.peoplePicker</em>.</p>

<ul>
<li><p><strong>allowMultiples</strong>      :   <em>Boolean. Optional. Default=true.</em> <br />
Determine whether multiple users can be picked.</p></li>
<li><p><strong>maxSearchResults</strong>    :   <em>Integer. Optional. Default=50.</em> <br />
The max number of results to be returned from the server.</p></li>
<li><p><strong>resolvePrincipals</strong>     :   <em>String. Optional. Default=true</em> <br />
When set to true (default), any person/group selected in the people picker that is not yet resolved (has -1 for ID and thus not part of Site List Info list) will be resolved first. Note that if setting this to false, could cause issues if attempting to update a people field on a list with a user that is not resolved. (Since v.2.3)</p></li>
<li><p><strong>type</strong>     :   <em>String. Optional. Default='User'</em> <br />
The type of search that should be done.  This input parameter is used as the underlying webservice PrincipalType value. Possible values include <em>User</em>, <em>DistributionList</em>, <em>SecurityGroup</em>, <em>SharePointGroup</em>, <em>All</em>, <em>None</em>. Default value is <em>User</em>.</p>

<p><em>Example</em>: Initiate a people picker that selects only Groups</p>

<pre><code>$("input[name='team']").pickSPUser({ type: 'SharePointGroup' });
</code></pre></li>
<li><p><strong>minLength</strong>    :   <em>Integer. Optional. Default=3.</em> <br />
The number of characters the user must type before suggestions are retrieved and displayed.</p></li>
<li><p><strong>appendTo</strong>    :   <em>selector. Optional.</em> Default=null<br />
The container where the autocomplete suggestions should be appended to. Default is inside of the People Picker widget container. See jQuery UI's Autocomplete for more on this options.</p></li>
<li><p><strong>webURL</strong>     :   <em>String. Optional. Default=current site</em> <br />
The WebURL for the list. (Since v2.1)</p></li>
<li><p><strong>onPickUser</strong>          :   <em>Function. Optional. Default=null.</em> <br />
Function that is called when user makes a selection. Function will have a context (<em>this</em> keyword) of the input field to which this plugin was bound, and will be given one input param; an object containing information about the selection made by the user. This object will contain data returned by the SharePoint's webservice.</p>

<p>Example:</p>

<pre><code>onPickUser: function(personObj) {
    // this = input element
    alert(personObj.displayName + " was selected!");
}
</code></pre></li>
<li><p><strong>onCreate</strong>            :   <em>Function. Optional. Default=null.</em> <br />
Function that is called after the widget has been initiated on an input element. Function will have a context (this keyword) of the input field to which this plugin is called on, which will also be provided as the first argument to the function. (Since v2.1)</p>

<p>Example:</p>

<pre><code>onCreate: function($input){
    // this = input element
}
</code></pre></li>
<li><p><strong>onRemoveUser</strong>    :   <em>Function. Optional. Default=null.</em> <br />
(Since v2.1) Function that is called when user makes removes a person from the selected list. Function will have a context (<em>this</em> keyword) of the input field to which this plugin was bound, and will be given the following two input parameters:</p>

<ul><li>Original Input field as jQuery object</li>
<li>The UI of the person (as jQuery object)</li>
<li>An object with data about the user that was selected</li></ul>

<p>Returning a (boolean) false will cancel the removal of the person from the selected list.</p>

<p>Example:</p>

<pre><code>onRemoveUser: function($input, $ui, personObj) {
    // this = input element
    // return false; // will cancel removal
}
</code></pre></li>
<li><p><strong>filterSuggestions</strong>    :   <em>Function. Optional. Default=null</em> <br />
A callback function to be used to filter the list of suggestions retrieved from the server. Method, if defined, <strong>must</strong> return an array (either empty or of Objects). (Since 2.4).
Function is given an <code>Array</code> of <code>Objects</code> as input. Each object represents the suggestion that will be displayed to the user. Each object will have the following structure:</p>

<pre><code>{
    accountId:      "999999"
    accountName:    "i:0#.f|membership|john.doe@spwidgets.com"
    accountType:    "User"
    displayName:    "John Doe"
    email:          "John.Doe@spwidgets.com"
    label:          "John Doe"
    value:          "John Doe"
}
</code></pre>

<p>The callback must return this same structure for each object when processing is complete. The <code>label</code> will be the visible value to the user when suggestions are displayed on the autocomplete widget and thus can be manipulated to show custom data.</p>

<p>Example:</p>

<pre><code>options.filterSuggestions = function(suggestions){
    var newSuggestions = [];


<pre><code>$.each(suggestions, function(i, userInfo){
    // If the user's ID is not -1, then add them return it.
    if (userInfo.accountId !== "-1") {
        // Change the visible label to include email
        userInfo.label = userInfo.label + " (" + userInfo.email + ")";
        newSuggestions.push(userInfo);
    }
});


return newSuggestions;
</code></pre>

}
</code></pre></li>
<li><p><strong>inputPlaceholder</strong>    :   <em>String. Optional. Default=Type and Pick.</em> <br />
The text to appear in the HTML5 placeholder attribute of the input field.  Since v2.1.</p></li>
<li><p><strong>meKeyword</strong> : <em>String. Optional. Default=[me]</em> <br />
The keyword used to represent the current user. When the user types this keyword, an additional suggestion is added to the autocomplete titled 'Current User' (value is configurable. See option below). This suggestion, when selected by the user, will use sharepoint's &lt;ThisUser/&gt; keyword instead of an ID;#name format and thus can be used to accomodate a dynamic setting based on the user using the widget.  (Since v.2.3)</p></li>
<li><p><strong>meKeywordLabel</strong> : <em>String. Optional. Default=Current User</em> <br />
The label to be shown on the suggestion box or selected list of user when using the [me] keyword.  (Since v.2.3)</p></li>
</ul>

<h2>Return Value</h2>

<p>This plugin will return a jQuery object that contains the initially selected set of node, thus maintaining chainability.</p>

<hr>

<h2>Utilities</h2>

<h3><strong>$().pickSPUser.resolvePrincipals(options)</strong></h3>

<p>A utility to resolve user accounts that may not be part of the site collection list info table. This is normally needed when a user's ID is -1: meaning the user is valid, but not part of the site collection (yet). By calling this method and setting the <em>addToUserInfoList</em> input option to true, that user will be added and receive a valid (positive) ID.  (Since v.2.3)</p>

<h4>Input parameters</h4>

<ul>
<li><strong>options</strong></br>
An object with the input options. See below for list of options</li>
</ul>

<h3>Options</h3>

<ul>
<li><p><strong>principalKeys</strong> :   <em>String|Array. REQUIRED</em> <br />
The account name, or email address of the principal to be resolved. Example: DOMAIN\userloginname.</p></li>
<li><p><strong>principalType</strong>:   <em>String. Optional. Default=All</em> <br />
The type of principal to be resolved. Valid values are: <em>User</em>, <em>DistributionList</em>, <em>SecurityGroup</em>, <em>SharePointGroup</em>, <em>All</em>, <em>None</em>. Default is All.</p></li>
<li><p><strong>addToUserInfoList</strong>:   <em>Boolean. Optional. Default=true</em> <br />
If true, then user will be added to site's List Info list.</p></li>
<li><p><strong>aysnc</strong>: <em>Boolean. Optional. Default=true</em> <br />
If true, request to the server will be done async.</p></li>
</ul>

<h3>Return</h3>

<p>Method returns a jQuery Promise (the one from $.ajax()). The promise (if successful) will provide its callback 3 input parameters: data (the xml response document), textStatus and the jQuery XHR request.</p>

<p>Example:<br/></p>

<pre><code>$().pickSPUser.resolvePrincipals({
    principalKey: "DOMAIN\PAUL"
})
.done(function(xmlDoc, textstatus, jqXHR){
    var $doc = $(xmlDoc);
    alert($doc.find("DisplayName").eq(0).text());
});
</code></pre>

<hr>

<h2>Methods</h2>

<p>All methods are called using the original input element where the People Picker widget was bound with the word 'method' as the first parameter:</p>

<pre><code>$("input[name='user']").pickSPUser("method", "method name here");
</code></pre>

<p>The following methods are supported:</p>

<ul>
<li><p><strong>clear()</strong><br />
Clears out all selected people</p>

<p>Example:</p>

<pre><code>$("input[name='user']").pickSPUser("method", "clear");
</code></pre></li>
<li><p><strong>destroy()</strong><br />
(Since v2.0) Removes the widget from the bound input element.</p>

<p>Example:</p>

<pre><code>$("input[name='user']").pickSPUser("method", "destroy");
</code></pre></li>
<li><p><strong>add('id;#name')</strong><br />
(Since v2.1) Adds a person to the seletion list. Method accepts one input:</p>

<ol><li><em>{String}</em> A string with people to add in the format of <em>id;#name</em></li></ol>

<p>Example:</p>

<pre><code>$("input[name='user']").pickSPUser("method", "add", '4;#John Smith');
</code></pre></li>
<li><p><strong>remove(id)</strong><br />
(Since v2.1) Removes a person from the selection.  Method accepts 1 input paramater.</p>

<ol><li><em>{String}</em> The ID or Display Name of the person that should be removed.</li></ol>

<p>Example:</p>

<pre><code>// Remove person with ID of 4
$("input[name='user']").pickSPUser("method", "remove", 4);


// remove John Smith
$("input[name='user']").pickSPUser("method", "remove", "John Smith");
</code></pre></li>
<li><p><strong>getSelected()</strong><br />
(Since v2.1) Returns an Array of objects representing the currently set of selected people.  The array object element will have the following structure:</p>

<pre><code>[
    {
        id: 'id of person',
        title: 'display name of person'
    }
]
</code></pre>

<p>Example:</p>

<pre><code>var selected = $("input[name='user']").pickSPUser("method", "getSelected");


alert("There are " + selected.length + " people selected!");
</code></pre></li>
</ul>

<hr>

<h2>Events</h2>

<p>The following Events are triggered by this widget</p>

<ul>
<li><p><strong>spwidget:peoplePickerCreate</strong> <br/>
(Since v2.1) Event is triggered after widget is initiated on an element. Event is given two input parameters:</p>

<ol><li>jQuery Event Object</li>
<li>Original Input field as jQuery object</li></ol>

<p>Example:</p>

<pre><code>$("input[name='user']")
    .on("spwidget:peoplePickerCreate", function(ev, $input){
        // ev.target = input element
    })
    .pickSPUser()
</code></pre></li>
<li><p><strong>spwidget:peoplePickerAdd</strong><br />
(Since v2.1) Event is triggered anytime the user selects a person/group. Event is given three input parameters:</p>

<ol><li>jQuery Event Object</li>
<li>Original Input field as jQuery object</li>
<li>An object with data about the user that was selected</li></ol>

<p>Example:</p>

<pre><code>$("input[name='user']")
    .on("spwidget:peoplePickerAdd", function(ev, $input, personObj){
        // ev.target = input element
    })
    .pickSPUser()
</code></pre></li>
<li><p><strong>spwidget:peoplePickerRemove</strong><br />
(Since v2.1) Event is triggered anytime the user removes a person/group from the selected list. Returning False (Boolean) will canceld the removal and leave the person in the selected list. Event is given three input parameters:</p>

<ol><li>jQuery Event Object</li>
<li>Original Input field as jQuery object</li>
<li>An object with data about the user that was selected</li></ol>

<p>Example:</p>

<pre><code>$("input[name='user']")
    .on("spwidget:peoplePickerRemove", function(ev, $input, personObj){
        // ev.target = input element
    })
    .pickSPUser()
</code></pre></li>
</ul>

<hr>

<h2>Examples</h2>

<p>Bind people picker and allow only 1 person to be selected/stored.</p>

<pre><code>$("input[name='users']").pickSPUser({
    allowMultiples: false
});
</code></pre>

<p>When user makes a selection, show alert with person's info.</p>

<pre><code>$("input[name='users']").pickSPUser({
    onPickUser: function(person){
        alert("User selected:
</code></pre>

<p>displayName: " +
                person.displayName + "
 accountId: " +
                person.accountId + "
 accountName: " +
                person.accountName + "
 accountType:" +
                person.accountType);
        }
    });</p>




<!-- ===============[[ doc above ]]=========================== -->
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/purtuga">purtuga</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    <script type="text/javascript">
        var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
        document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
        try {
          var pageTracker = _gat._getTracker("UA-35374531-2");
        pageTracker._trackPageview();
        } catch(err) {}
    </script>
  </body>
</html>